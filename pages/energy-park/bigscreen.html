<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>能源大屏 - 慧新全智厂园一体平台</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <style>
    body { background: #0b1220; }
    .card { background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.12); }
  </style>
</head>
<body class="text-gray-200">
  <div class="max-w-7xl mx-auto px-4 py-6">
    <div class="mb-6">
      <h1 class="text-2xl font-bold flex items-center">
        <i class="fas fa-tv text-cyan-400 mr-3"></i>
        能源监控大屏（概念展示）
      </h1>
      <p class="text-gray-400 mt-1">聚合园区最重要的能源数据与状态，科技感布局</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
      <div class="card rounded-lg p-6 lg:col-span-2">
        <h3 class="text-lg font-semibold mb-2 flex items-center">
          <i class="fas fa-bolt text-yellow-300 mr-2"></i>实时功率曲线
        </h3>
        <div id="bs-line" class="h-56"></div>
      </div>
      <div class="card rounded-lg p-6">
        <h3 class="text-lg font-semibold mb-2 flex items-center">
          <i class="fas fa-sun text-yellow-300 mr-2"></i>当日能耗概览
        </h3>
        <ul class="text-sm space-y-1">
          <li>电：12,560 kWh</li>
          <li>水：2,180 m³</li>
          <li>气：1,280 m³</li>
          <li>冷/热：856 RT·h</li>
        </ul>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
      <div class="card rounded-lg p-6">
        <h3 class="text-lg font-semibold mb-2 flex items-center">
          <i class="fas fa-chart-pie text-pink-300 mr-2"></i>用电分类占比
        </h3>
        <div id="bs-pie" class="h-44"></div>
      </div>
      <div class="card rounded-lg p-6">
        <h3 class="text-lg font-semibold mb-2 flex items-center">
          <i class="fas fa-temperature-low text-blue-300 mr-2"></i>室外环境</h3>
        <div class="h-44 rounded bg-gradient-to-r from-blue-900 to-blue-700/60 flex items-center justify-center text-blue-100">温度/湿度/PM2.5</div>
      </div>
      <div class="card rounded-lg p-6">
        <h3 class="text-lg font-semibold mb-2 flex items-center">
          <i class="fas fa-exclamation-triangle text-yellow-300 mr-2"></i>告警信息</h3>
        <ul class="text-sm space-y-1">
          <li>待处理告警：3</li>
          <li>最近异常：照明支路过载（M-3）</li>
          <li>查看详情 → 报警列表</li>
        </ul>
      </div>
    </div>

    <div class="card rounded-lg p-6">
      <h3 class="text-lg font-semibold mb-2 flex items-center">
        <i class="fas fa-building text-emerald-300 mr-2"></i>园区一张图（示意）
      </h3>
      <div id="facility-map" class="h-64 rounded relative overflow-hidden" style="background: radial-gradient(ellipse at center, rgba(30,58,138,0.35), rgba(15,23,42,0.9)); border: 1px solid rgba(255,255,255,0.12);">
        <svg id="facility-svg" viewBox="0 0 1000 400" preserveAspectRatio="xMidYMid meet" class="w-full h-full"></svg>
        <div id="facility-tooltip" class="hidden absolute z-10 bg-slate-900/90 text-gray-100 text-xs rounded shadow-lg border border-white/10 p-3" style="min-width: 160px;"></div>
      </div>
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      const lineEl = document.getElementById('bs-line');
      if (lineEl) {
        const c = echarts.init(lineEl);
        const t = Array.from({length:24}, (_,i)=> `${i}:00`);
        const v = t.map((_,i)=> 1000 + Math.round(300*Math.abs(Math.sin(i/4))) + Math.round(Math.random()*100));
        c.setOption({
          tooltip:{ trigger:'axis' },
          xAxis:{ type:'category', data:t, boundaryGap:false },
          yAxis:{ type:'value', name:'kW' },
          series:[{ type:'line', data:v, areaStyle:{}, smooth:true, color:'#60a5fa' }]
        });
        window.addEventListener('resize', ()=> c.resize());
      }

      const pieEl = document.getElementById('bs-pie');
      if (pieEl) {
        const p = echarts.init(pieEl);
        p.setOption({
          tooltip:{ trigger:'item' },
          series:[{ type:'pie', radius:['35%','60%'], label:{ color:'#ddd' }, data:[
            {name:'照明', value: 18},
            {name:'动力', value: 44},
            {name:'暖通', value: 22},
            {name:'电梯', value: 8},
            {name:'消防', value: 8}
          ]}]
        });
      // 设施示意图（SVG，可点击区域）
      const svg = document.getElementById('facility-svg');
      const tooltip = document.getElementById('facility-tooltip');

      const zones = [
        { id:'packA', name:'PACK产线A',      x:60,  y:60,  w:340, h:120, power:850,  status:'green' },
        { id:'inverter', name:'逆变器车间',  x:420, y:60,  w:260, h:120, power:1200, status:'yellow' },
        { id:'warehouse', name:'仓库C',      x:700, y:60,  w:220, h:120, power:300,  status:'green' },
        { id:'office', name:'办公楼B',       x:60,  y:210, w:260, h:110, power:180,  status:'green' },
        { id:'cooling', name:'制冷站',       x:340, y:210, w:220, h:110, power:420,  status:'green' },
        { id:'substation', name:'变电所',    x:580, y:210, w:340, h:110, power:960,  status:'red' }
      ];

      const statusColor = { green:'#10b981', yellow:'#f59e0b', red:'#ef4444' };
      const strokeColor = 'rgba(255,255,255,0.35)';
      const fillBase = 'rgba(99,102,241,0.15)';

      // 渲染矩形区域
      zones.forEach(z => {
        const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
        g.setAttribute('cursor','pointer');

        const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
        rect.setAttribute('x', z.x);
        rect.setAttribute('y', z.y);
        rect.setAttribute('rx', 10);
        rect.setAttribute('ry', 10);
        rect.setAttribute('width', z.w);
        rect.setAttribute('height', z.h);
        rect.setAttribute('fill', fillBase);
        rect.setAttribute('stroke', strokeColor);
        rect.setAttribute('stroke-width', 1);
        g.appendChild(rect);

        // 左上角状态灯
        const led = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        led.setAttribute('cx', z.x + 14);
        led.setAttribute('cy', z.y + 14);
        led.setAttribute('r', 6);
        led.setAttribute('fill', statusColor[z.status] || '#10b981');
        g.appendChild(led);

        // 标题
        const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        title.setAttribute('x', z.x + 30);
        title.setAttribute('y', z.y + 22);
        title.setAttribute('fill', '#e5e7eb');
        title.setAttribute('font-size', '14');
        title.setAttribute('font-weight', '600');
        title.textContent = z.name;
        g.appendChild(title);

        // 功率读数（右下角）
        const value = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        value.setAttribute('x', z.x + z.w - 10);
        value.setAttribute('y', z.y + z.h - 10);
        value.setAttribute('fill', '#93c5fd');
        value.setAttribute('text-anchor', 'end');
        value.setAttribute('font-size', '18');
        value.setAttribute('font-weight', '700');
        value.textContent = `${z.power} kW`;
        g.appendChild(value);

        // 点击交互
        g.addEventListener('click', (evt) => {
          const rect = evt.currentTarget.getBBox();
          showTooltip(rect.x + rect.width/2, rect.y + rect.height/2, z);
        });

        // 悬停高亮
        g.addEventListener('mouseenter', () => rect.setAttribute('fill','rgba(99,102,241,0.28)'));
        g.addEventListener('mouseleave', () => { rect.setAttribute('fill', fillBase); hideTooltip(); });

        svg.appendChild(g);
      });

      function showTooltip(cx, cy, z){
        const map = document.getElementById('facility-map');
        const rect = map.getBoundingClientRect();
        tooltip.innerHTML = `
          <div class="font-semibold mb-1">${z.name}</div>
          <div class="flex items-center justify-between mb-1"><span class="text-gray-300">状态</span><span style="color:${statusColor[z.status]}">${z.status==='green'?'正常':z.status==='yellow'?'预警':'告警'}</span></div>
          <div class="flex items-center justify-between mb-1"><span class="text-gray-300">当前功率</span><span class="text-indigo-300 font-semibold">${z.power} kW</span></div>
          <div class="text-gray-300">近5分钟：${(z.power*0.92).toFixed(0)}→${z.power} kW</div>
        `;
        tooltip.style.left = (cx/1000*rect.width - 80) + 'px';
        tooltip.style.top  = (cy/400*rect.height - 80) + 'px';
        tooltip.classList.remove('hidden');
      }
      function hideTooltip(){ tooltip.classList.add('hidden'); }

      // 模拟实时读数微动
      setInterval(() => {
        const texts = svg.querySelectorAll('text');
        zones.forEach((z, idx) => {
          // 只更新功率（每组第3个 text 元素）
          const groupOffset = idx*3; // title, value 前还有 LED/rect，不在 textNode 里
          const powerText = texts[groupOffset + 1];
          if (powerText) {
            const jitter = Math.round((Math.random()-0.5)*30);
            const val = Math.max(0, z.power + jitter);
            powerText.textContent = `${val} kW`;
          }
        });
      }, 2000);

      // 响应式缩放由 viewBox+preserveAspectRatio 保障，无需额外处理

        window.addEventListener('resize', ()=> p.resize());
      }
    });
  </script>
    </div>
  </div>
</body>
</html>

