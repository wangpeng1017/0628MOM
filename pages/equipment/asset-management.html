<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设备资产管理 - 设备管理 - 数字工厂一体化平台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#1e40af',
                        'primary-light': '#3b82f6',
                        'secondary': '#6b7280',
                        'success': '#10b981',
                        'warning': '#f59e0b',
                        'danger': '#ef4444'
                    }
                }
            }
        }
    </script>
    <style>
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
        .modal.show { display: flex; align-items: center; justify-content: center; }
        .tab-button { border-bottom: 3px solid transparent; transition: all 0.3s; }
        .tab-button.active { border-bottom-color: #3b82f6; color: #3b82f6; font-weight: 600; }
        .tree-item { cursor: pointer; transition: background-color 0.2s; padding: 8px; margin: 2px 0; border-radius: 6px; }
        .tree-item:hover { background-color: #f3f4f6; }
        .tree-item.selected { background-color: #dbeafe; border-left: 3px solid #3b82f6; }
        .tree-children { margin-left: 20px; }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex h-screen overflow-hidden">
        <!-- 左侧设备树 -->
        <div class="w-80 bg-white border-r border-gray-200 flex flex-col">
            <div class="p-4 border-b">
                <h2 class="text-lg font-bold text-gray-800 mb-3">设备组织结构</h2>
                <div class="flex gap-2 mb-3">
                    <button onclick="switchTreeView('location')" id="view-location" class="flex-1 px-3 py-2 text-sm bg-primary text-white rounded hover:bg-blue-700 transition-colors">
                        <i class="fas fa-sitemap mr-1"></i>物理位置
                    </button>
                    <button onclick="switchTreeView('category')" id="view-category" class="flex-1 px-3 py-2 text-sm bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors">
                        <i class="fas fa-layer-group mr-1"></i>功能类别
                    </button>
                </div>
                <input type="text" id="tree-search" placeholder="搜索设备..." class="w-full px-3 py-2 border rounded text-sm focus:ring-2 focus:ring-primary-light focus:border-transparent">
            </div>
            <div class="flex-1 overflow-y-auto p-4" id="tree-container">
                <!-- 物理位置树 -->
                <div id="tree-location">
                    <div class="tree-item selected" onclick="selectTreeNode(this, '全部')">
                        <i class="fas fa-building text-primary mr-2"></i>
                        <span class="font-medium">宁波工厂</span>
                        <span class="text-xs text-gray-500 ml-2">(1248)</span>
                    </div>
                    <div class="tree-children">
                        <div class="tree-item" onclick="selectTreeNode(this, 'A车间')">
                            <i class="fas fa-warehouse text-success mr-2"></i>
                            <span>A车间 - SMT产线</span>
                            <span class="text-xs text-gray-500 ml-2">(156)</span>
                        </div>
                        <div class="tree-item" onclick="selectTreeNode(this, 'B车间')">
                            <i class="fas fa-warehouse text-success mr-2"></i>
                            <span>B车间 - 测试区</span>
                            <span class="text-xs text-gray-500 ml-2">(89)</span>
                        </div>
                        <div class="tree-item" onclick="selectTreeNode(this, 'D车间')">
                            <i class="fas fa-warehouse text-success mr-2"></i>
                            <span>D车间 - 组件产线</span>
                            <span class="text-xs text-gray-500 ml-2">(203)</span>
                        </div>
                        <div class="tree-item" onclick="selectTreeNode(this, 'C车间')">
                            <i class="fas fa-warehouse text-success mr-2"></i>
                            <span>C车间 - 机加工区</span>
                            <span class="text-xs text-gray-500 ml-2">(124)</span>
                        </div>
                    </div>
                </div>
                <!-- 功能类别树 -->
                <div id="tree-category" style="display:none;">
                    <div class="tree-item" onclick="selectTreeNode(this, '生产设备')">
                        <i class="fas fa-cogs text-primary mr-2"></i>
                        <span class="font-medium">生产设备</span>
                        <span class="text-xs text-gray-500 ml-2">(687)</span>
                    </div>
                    <div class="tree-item" onclick="selectTreeNode(this, '测试设备')">
                        <i class="fas fa-vial text-teal-600 mr-2"></i>
                        <span class="font-medium">测试设备</span>
                        <span class="text-xs text-gray-500 ml-2">(234)</span>
                    </div>
                    <div class="tree-item" onclick="selectTreeNode(this, '检测设备')">
                        <i class="fas fa-microscope text-purple-600 mr-2"></i>
                        <span class="font-medium">检测设备</span>
                        <span class="text-xs text-gray-500 ml-2">(178)</span>
                    </div>
                    <div class="tree-item" onclick="selectTreeNode(this, '动力设备')">
                        <i class="fas fa-bolt text-warning mr-2"></i>
                        <span class="font-medium">动力设备</span>
                        <span class="text-xs text-gray-500 ml-2">(89)</span>
                    </div>
                    <div class="tree-item" onclick="selectTreeNode(this, '物流设备')">
                        <i class="fas fa-truck text-indigo-600 mr-2"></i>
                        <span class="font-medium">物流设备</span>
                        <span class="text-xs text-gray-500 ml-2">(60)</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 右侧主内容 -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- 顶部操作栏 -->
            <div class="bg-white border-b p-6">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">设备台账管理</h1>
                        <p class="text-sm text-gray-600 mt-1">全生命周期设备档案管理 | 支持二维码标识 | 动态履历追溯</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="openModal('form')" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                            <i class="fas fa-plus mr-2"></i>新建设备
                        </button>
                        <button onclick="openModal('import')" class="px-4 py-2 bg-success text-white rounded-lg hover:bg-green-700 transition-colors flex items-center">
                            <i class="fas fa-file-import mr-2"></i>批量导入
                        </button>
                        <button onclick="openModal('qrcode')" class="px-4 py-2 bg-warning text-white rounded-lg hover:bg-yellow-600 transition-colors flex items-center">
                            <i class="fas fa-qrcode mr-2"></i>二维码
                        </button>
                        <button onclick="exportData()" class="px-4 py-2 bg-secondary text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center">
                            <i class="fas fa-download mr-2"></i>导出
                        </button>
                    </div>
                </div>
                <!-- 统计卡片 -->
                <div class="grid grid-cols-5 gap-4">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-blue-600 font-medium">设备总量</p>
                                <p class="text-2xl font-bold text-blue-700">1,248</p>
                            </div>
                            <i class="fas fa-industry text-blue-600 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-green-600 font-medium">在用</p>
                                <p class="text-2xl font-bold text-green-700">1,142</p>
                            </div>
                            <i class="fas fa-check-circle text-green-600 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-yellow-600 font-medium">保养中</p>
                                <p class="text-2xl font-bold text-yellow-700">38</p>
                            </div>
                            <i class="fas fa-wrench text-yellow-600 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-orange-600 font-medium">维修中</p>
                                <p class="text-2xl font-bold text-orange-700">52</p>
                            </div>
                            <i class="fas fa-tools text-orange-600 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-red-600 font-medium">待报废</p>
                                <p class="text-2xl font-bold text-red-700">16</p>
                            </div>
                            <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 筛选器 -->
            <div class="bg-white border-b p-4">
                <div class="flex flex-col gap-3">
                    <div class="flex gap-3">
                        <input type="text" id="filter-code" placeholder="设备编码/名称" class="flex-1 px-3 py-2 border rounded text-sm focus:ring-2 focus:ring-primary-light focus:border-transparent">
                        <select id="filter-status" class="w-40 px-3 py-2 border rounded text-sm focus:ring-2 focus:ring-primary-light focus:border-transparent">
                            <option value="">全部状态</option>
                            <option value="在用">在用</option>
                            <option value="保养中">保养中</option>
                            <option value="维修中">维修中</option>
                            <option value="停机">停机</option>
                            <option value="待报废">待报废</option>
                        </select>
                        <select id="filter-category" class="w-40 px-3 py-2 border rounded text-sm focus:ring-2 focus:ring-primary-light focus:border-transparent">
                            <option value="">全部类别</option>
                            <option value="生产设备">生产设备</option>
                            <option value="测试设备">测试设备</option>
                            <option value="检测设备">检测设备</option>
                            <option value="动力设备">动力设备</option>
                            <option value="物流设备">物流设备</option>
                        </select>
                        <button onclick="applyFilters()" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors">
                            <i class="fas fa-search mr-2"></i>查询
                        </button>
                        <button onclick="resetFilters()" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors">
                            <i class="fas fa-redo mr-2"></i>重置
                        </button>
                    </div>
                    <div class="flex gap-2">
                        <button id="asset-view-list-btn" onclick="switchAssetView('list')" class="px-3 py-1 text-xs bg-primary text-white rounded border border-primary flex items-center">
                            <i class="fas fa-list-ul mr-1"></i>台账列表
                        </button>
                        <button id="asset-view-topology-btn" onclick="switchAssetView('topology')" class="px-3 py-1 text-xs bg-white text-gray-700 rounded border border-gray-300 hover:bg-gray-50 flex items-center">
                            <i class="fas fa-project-diagram mr-1"></i>拓扑视图
                        </button>
                    </div>
                </div>
            </div>

            <!-- 设备列表 / 拓扑视图 -->
            <div class="flex-1 overflow-auto p-6">
                <div id="asset-list-view" class="bg-white rounded-lg shadow-sm border border-gray-200">
                    <div class="p-4 border-b flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <input type="checkbox" id="select-all" onclick="toggleSelectAll(this)" class="rounded">
                            <span class="text-sm text-gray-600">已选择 <span id="selected-count">0</span> 项</span>
                        </div>
                        <div class="text-sm text-gray-600">
                            共 <span class="font-semibold text-primary">1,248</span> 条记录
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-50 border-b">
                                <tr>
                                    <th class="px-4 py-3 text-left w-12"><input type="checkbox" class="rounded"></th>
                                    <th class="px-4 py-3 text-left font-semibold text-gray-700">设备编码</th>
                                    <th class="px-4 py-3 text-left font-semibold text-gray-700">设备名称</th>
                                    <th class="px-4 py-3 text-left font-semibold text-gray-700">设备类别</th>
                                    <th class="px-4 py-3 text-left font-semibold text-gray-700">物理位置</th>
                                    <th class="px-4 py-3 text-left font-semibold text-gray-700">当前状态</th>
                                    <th class="px-4 py-3 text-left font-semibold text-gray-700">责任人</th>
                                    <th class="px-4 py-3 text-left font-semibold text-gray-700">启用日期</th>
                                    <th class="px-4 py-3 text-left font-semibold text-gray-700">运行时长(h)</th>
                                    <th class="px-4 py-3 text-center font-semibold text-gray-700 w-56">操作</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y" id="equipment-tbody">
                                <!-- 数据将通过JS动态生成 -->
                            </tbody>
                        </table>
                    </div>
                    <div class="p-4 border-t flex items-center justify-between">
                        <div class="text-sm text-gray-600">显示第 1 - 20 条，共 1,248 条</div>
                        <div class="flex gap-2">
                            <button class="px-3 py-1 border rounded text-sm hover:bg-gray-50 transition-colors">上一页</button>
                            <button class="px-3 py-1 bg-primary text-white rounded text-sm">1</button>
                            <button class="px-3 py-1 border rounded text-sm hover:bg-gray-50 transition-colors">2</button>
                            <button class="px-3 py-1 border rounded text-sm hover:bg-gray-50 transition-colors">3</button>
                            <span class="px-3 py-1 text-sm text-gray-500">...</span>
                            <button class="px-3 py-1 border rounded text-sm hover:bg-gray-50 transition-colors">63</button>
                            <button class="px-3 py-1 border rounded text-sm hover:bg-gray-50 transition-colors">下一页</button>
                        </div>
                    </div>
                </div>

                <!-- 设备拓扑视图：展示设备间关联关系及状态（示意） -->
                <div id="asset-topology-view" class="mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6" style="display:none;">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2">
                            <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                                <i class="fas fa-project-diagram mr-2 text-primary"></i>设备拓扑图可视化
                            </h3>
                            <span class="text-xs text-gray-500">示意：展示产线/设备/测试工位之间的上下游关系与状态</span>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- 上游供给系统 -->
                        <div class="flex flex-col items-center">
                            <div class="w-56 bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <p class="text-xs font-semibold text-blue-700 mb-1">上游供给系统</p>
                                <p class="text-sm font-medium text-gray-800">动力/气源/环境</p>
                                <ul class="mt-2 text-xs text-gray-600 space-y-1">
                                    <li>• 空压机站（运行中）</li>
                                    <li>• 冷冻水系统（运行中）</li>
                                    <li>• 智能配电柜（注意级预警）</li>
                                </ul>
                            </div>
                            <div class="h-10 border-l-2 border-dashed border-gray-300"></div>
                            <div class="w-40 text-center text-xs text-gray-500">为产线提供动力/气源/电力</div>
                        </div>

                        <!-- 产线核心设备链路 -->
                        <div class="relative flex flex-col items-center">
                            <div class="w-full flex flex-col items-center">
                                <div class="w-64 bg-green-50 border border-green-200 rounded-lg p-4 mb-3">
                                    <div class="flex items-center justify-between mb-1">
                                        <span class="text-sm font-semibold text-gray-800">SMT-1号线</span>
                                        <span class="inline-flex items-center text-xs text-green-700">
                                            <span class="w-2 h-2 rounded-full bg-green-500 mr-1"></span>整体运行中
                                        </span>
                                    </div>
                                    <p class="text-xs text-gray-600">贴片机 → 回流焊 → AOI检测</p>
                                </div>
                                <div class="flex items-center justify-between w-full">
                                    <div class="w-56 bg-white border border-gray-200 rounded-lg p-3">
                                        <div class="flex items-center justify-between mb-1">
                                            <span class="text-xs font-semibold text-gray-800">全自动贴片机</span>
                                            <span class="inline-flex items-center text-xs text-green-700">
                                                <span class="w-2 h-2 rounded-full bg-green-500 mr-1"></span>运行中
                                            </span>
                                        </div>
                                        <p class="text-[11px] text-gray-500">EQ-2024-001 · YSM20R</p>
                                    </div>
                                    <div class="flex-1 flex items-center justify-center">
                                        <div class="w-10 border-t-2 border-dashed border-gray-300"></div>
                                        <i class="fas fa-angles-right text-gray-400 text-xs mx-1"></i>
                                        <div class="w-10 border-t-2 border-dashed border-gray-300"></div>
                                    </div>
                                    <div class="w-56 bg-white border border-orange-200 rounded-lg p-3">
                                        <div class="flex items-center justify-between mb-1">
                                            <span class="text-xs font-semibold text-gray-800">组件层压机</span>
                                            <span class="inline-flex items-center text-xs text-orange-700">
                                                <span class="w-2 h-2 rounded-full bg-orange-500 mr-1"></span>维修中
                                            </span>
                                        </div>
                                        <p class="text-[11px] text-gray-500">EQ-2024-033 · D车间/组件线-2</p>
                                    </div>
                                </div>
                                <div class="mt-4 w-full flex items-center justify-center">
                                    <div class="w-56 bg-white border border-yellow-200 rounded-lg p-3">
                                        <div class="flex items-center justify-between mb-1">
                                            <span class="text-xs font-semibold text-gray-800">逆变器老化测试台</span>
                                            <span class="inline-flex items-center text-xs text-yellow-700">
                                                <span class="w-2 h-2 rounded-full bg-yellow-400 mr-1"></span>保养中
                                            </span>
                                        </div>
                                        <p class="text-[11px] text-gray-500">EQ-2024-019 · B车间/测试区</p>
                                        <p class="mt-1 text-[11px] text-gray-500">与组件层压机存在测试/返修闭环</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 下游检测与包装 -->
                        <div class="flex flex-col items-center">
                            <div class="w-56 bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                                <p class="text-xs font-semibold text-indigo-700 mb-1">下游检测/包装</p>
                                <p class="text-sm font-medium text-gray-800">质检工位 & 包装线</p>
                                <ul class="mt-2 text-xs text-gray-600 space-y-1">
                                    <li>• 在线测试设备（运行中）</li>
                                    <li>• 抽检试验室（运行中）</li>
                                    <li>• 包装机E1（空闲，可调配）</li>
                                </ul>
                            </div>
                            <div class="h-10 border-l-2 border-dashed border-gray-300"></div>
                            <div class="w-40 text-center text-xs text-gray-500">与上游设备形成完整产线拓扑</div>
                        </div>
                    </div>

                    <div class="mt-6 flex flex-wrap items-center gap-4 text-xs text-gray-500">
                        <div class="flex items-center gap-2">
                            <span class="inline-flex items-center"><span class="w-2 h-2 rounded-full bg-green-500 mr-1"></span>运行中</span>
                            <span class="inline-flex items-center"><span class="w-2 h-2 rounded-full bg-yellow-400 mr-1"></span>保养中/注意</span>
                            <span class="inline-flex items-center"><span class="w-2 h-2 rounded-full bg-orange-500 mr-1"></span>维修中/严重</span>
                            <span class="inline-flex items-center"><span class="w-2 h-2 rounded-full bg-red-500 mr-1"></span>危险/停机</span>
                        </div>
                        <div class="text-[11px] text-gray-400">
                            提示：正式实现中可接入 IoT/预测性维护数据，动态渲染拓扑与状态，并支持点击节点跳转至设备详情/工单。
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 设备详情弹窗 -->
    <div id="modal-detail" class="modal">
        <div class="bg-white rounded-lg w-full max-w-5xl max-h-[90vh] overflow-hidden shadow-2xl">
            <div class="flex items-center justify-between p-6 border-b bg-gray-50">
                <h2 class="text-xl font-bold text-gray-800">设备详情</h2>
                <button onclick="closeModal('detail')" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="border-b">
                <div class="flex px-6">
                    <button class="tab-button px-6 py-3 font-medium active" onclick="switchDetailTab('basic')">
                        <i class="fas fa-info-circle mr-2"></i>基本信息
                    </button>
                    <button class="tab-button px-6 py-3 font-medium" onclick="switchDetailTab('tech')">
                        <i class="fas fa-cog mr-2"></i>技术参数
                    </button>
                    <button class="tab-button px-6 py-3 font-medium" onclick="switchDetailTab('history')">
                        <i class="fas fa-history mr-2"></i>设备履历
                    </button>
                    <button class="tab-button px-6 py-3 font-medium" onclick="switchDetailTab('files')">
                        <i class="fas fa-folder-open mr-2"></i>附件文档
                    </button>
                    <button class="tab-button px-6 py-3 font-medium" onclick="switchDetailTab('maintenance')">
                        <i class="fas fa-tools mr-2"></i>维保记录
                    </button>
                </div>
            </div>
            <div class="p-6 overflow-y-auto" style="max-height: calc(90vh - 180px);">
                <div id="tab-basic">
                    <div class="grid grid-cols-2 gap-8">
                        <div>
                            <h3 class="font-semibold text-lg mb-4 text-primary flex items-center">
                                <i class="fas fa-database mr-2"></i>静态属性
                            </h3>
                            <div class="space-y-3 text-sm">
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">设备编码:</span><span class="font-medium text-gray-900" id="detail-code">EQ-2024-001</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">设备名称:</span><span class="font-medium text-gray-900" id="detail-name">全自动贴片机</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">设备型号:</span><span class="font-medium text-gray-900">YAMAHA YSM20R</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">制造商:</span><span class="font-medium text-gray-900">雅马哈机器人</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">采购日期:</span><span class="font-medium text-gray-900">2023-01-10</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">原值:</span><span class="font-medium text-gray-900">¥1,280,000</span></div>
                                <div class="flex py-2"><span class="w-32 text-gray-600">供应商:</span><span class="font-medium text-gray-900">上海雅马哈贸易有限公司</span></div>
                            </div>
                        </div>
                        <div>
                            <h3 class="font-semibold text-lg mb-4 text-success flex items-center">
                                <i class="fas fa-sync-alt mr-2"></i>动态属性
                            </h3>
                            <div class="space-y-3 text-sm">
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">当前状态:</span><span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium">在用</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">物理位置:</span><span class="font-medium text-gray-900">宁波工厂/A车间/SMT-1号线</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">责任人:</span><span class="font-medium text-gray-900">张工 (13800138000)</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">启用日期:</span><span class="font-medium text-gray-900">2023-01-15</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">累计运行:</span><span class="font-medium text-gray-900">9,520 小时</span></div>
                                <div class="flex py-2 border-b"><span class="w-32 text-gray-600">净值:</span><span class="font-medium text-gray-900">¥684,000</span></div>
                                <div class="flex py-2"><span class="w-32 text-gray-600">二维码:</span>
                                    <button class="text-primary hover:text-blue-700 text-sm font-medium transition-colors">
                                        <i class="fas fa-qrcode mr-1"></i>查看/打印二维码
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="tab-tech" style="display:none;">
                    <h3 class="font-semibold text-lg mb-4 text-primary flex items-center">
                        <i class="fas fa-cog mr-2"></i>技术参数
                    </h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 bg-blue-50 border border-blue-100 rounded-lg">
                            <span class="text-gray-600 text-sm">额定功率:</span>
                            <span class="ml-2 font-semibold text-gray-900">15 kW</span>
                        </div>
                        <div class="p-4 bg-blue-50 border border-blue-100 rounded-lg">
                            <span class="text-gray-600 text-sm">工作电压:</span>
                            <span class="ml-2 font-semibold text-gray-900">380V 3相</span>
                        </div>
                        <div class="p-4 bg-blue-50 border border-blue-100 rounded-lg">
                            <span class="text-gray-600 text-sm">贴装速度:</span>
                            <span class="ml-2 font-semibold text-gray-900">20,000 CPH</span>
                        </div>
                        <div class="p-4 bg-blue-50 border border-blue-100 rounded-lg">
                            <span class="text-gray-600 text-sm">贴装精度:</span>
                            <span class="ml-2 font-semibold text-gray-900">±0.025mm</span>
                        </div>
                        <div class="p-4 bg-blue-50 border border-blue-100 rounded-lg">
                            <span class="text-gray-600 text-sm">PCB尺寸:</span>
                            <span class="ml-2 font-semibold text-gray-900">50x50 ~ 510x460mm</span>
                        </div>
                        <div class="p-4 bg-blue-50 border border-blue-100 rounded-lg">
                            <span class="text-gray-600 text-sm">元件范围:</span>
                            <span class="ml-2 font-semibold text-gray-900">0201 ~ 74x74mm</span>
                        </div>
                    </div>
                </div>
                <div id="tab-history" style="display:none;">
                    <h3 class="font-semibold text-lg mb-4 text-primary flex items-center">
                        <i class="fas fa-history mr-2"></i>设备履历时间轴
                    </h3>
                    <div id="history-timeline"></div>
                </div>
                <div id="tab-files" style="display:none;">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-semibold text-lg text-primary flex items-center">
                            <i class="fas fa-folder-open mr-2"></i>附件文档列表
                        </h3>
                        <button onclick="uploadAttachment()" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                            <i class="fas fa-upload mr-2"></i>上传附件
                        </button>
                        <input type="file" id="attachment-file-input" style="display:none;" onchange="handleAttachmentUpload(event)">
                    </div>
                    <div id="attachments-list"></div>
                </div>
                <div id="tab-maintenance" style="display:none;">
                    <h3 class="font-semibold text-lg mb-4 text-primary flex items-center">
                        <i class="fas fa-tools mr-2"></i>维保记录
                    </h3>
                    <table class="w-full text-sm">
                        <thead class="bg-gray-50 border-b">
                            <tr>
                                <th class="px-4 py-2 text-left">工单号</th>
                                <th class="px-4 py-2 text-left">类型</th>
                                <th class="px-4 py-2 text-left">描述</th>
                                <th class="px-4 py-2 text-left">处理人</th>
                                <th class="px-4 py-2 text-left">完成时间</th>
                                <th class="px-4 py-2 text-left">状态</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y">
                            <tr>
                                <td class="px-4 py-2 text-primary font-medium">WO-2024-001</td>
                                <td class="px-4 py-2"><span class="px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-xs">保养</span></td>
                                <td class="px-4 py-2">月度保养</td>
                                <td class="px-4 py-2">李工</td>
                                <td class="px-4 py-2">2024-10-20</td>
                                <td class="px-4 py-2"><span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs">已完成</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 设备表单弹窗 -->
    <div id="modal-form" class="modal">
        <div class="bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl">
            <div class="flex items-center justify-between p-6 border-b bg-gray-50">
                <h2 class="text-xl font-bold text-gray-800">新建设备档案</h2>
                <button onclick="closeModal('form')" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6 overflow-y-auto" style="max-height: calc(90vh - 180px);">
                <form id="equipment-form" class="space-y-6">
                    <div class="grid grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">设备编码 *</label>
                            <input type="text" id="form-code" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" placeholder="系统自动生成" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">设备名称 *</label>
                            <input type="text" id="form-name" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" placeholder="请输入设备名称" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">设备型号 *</label>
                            <input type="text" id="form-model" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" placeholder="请输入设备型号" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">设备类别 *</label>
                            <select id="form-category" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" required>
                                <option value="">请选择</option>
                                <option value="生产设备">生产设备</option>
                                <option value="测试设备">测试设备</option>
                                <option value="检测设备">检测设备</option>
                                <option value="动力设备">动力设备</option>
                                <option value="物流设备">物流设备</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">制造商</label>
                            <input type="text" id="form-manufacturer" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" placeholder="请输入制造商">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">采购日期</label>
                            <input type="date" id="form-purchase-date" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">原值(元)</label>
                            <input type="number" id="form-value" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" placeholder="请输入原值">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">物理位置 *</label>
                            <select id="form-location" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" required>
                                <option value="">请选择</option>
                                <option value="宁波工厂/A车间/SMT-1号线">宁波工厂/A车间/SMT-1号线</option>
                                <option value="宁波工厂/B车间/测试区">宁波工厂/B车间/测试区</option>
                                <option value="宁波工厂/D车间/组件线-2">宁波工厂/D车间/组件线-2</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">责任人 *</label>
                            <select id="form-owner" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" required>
                                <option value="">请选择</option>
                                <option value="张工">张工</option>
                                <option value="李工">李工</option>
                                <option value="王工">王工</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">启用日期</label>
                            <input type="date" id="form-start-date" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">备注</label>
                        <textarea id="form-notes" class="w-full px-3 py-2 border rounded focus:ring-2 focus:ring-primary-light focus:border-transparent" rows="3" placeholder="请输入备注信息"></textarea>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-3 p-6 border-t bg-gray-50">
                <button onclick="closeModal('form')" class="px-6 py-2 border rounded-lg hover:bg-gray-100 transition-colors">取消</button>
                <button onclick="saveEquipment()" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors">保存</button>
            </div>
        </div>
    </div>

    <!-- 二维码弹窗 -->
    <div id="modal-qrcode" class="modal">
        <div class="bg-white rounded-lg w-full max-w-2xl overflow-hidden shadow-2xl">
            <div class="flex items-center justify-between p-6 border-b bg-gray-50">
                <h2 class="text-xl font-bold text-gray-800">设备二维码</h2>
                <button onclick="closeModal('qrcode')" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-8">
                <div id="qrcode-display" class="text-center mb-6"></div>
                <div class="flex justify-center gap-4">
                    <button onclick="printQRCode()" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center">
                        <i class="fas fa-print mr-2"></i>打印二维码
                    </button>
                    <button onclick="downloadQRCode()" class="px-6 py-2 bg-success text-white rounded-lg hover:bg-green-700 transition-colors flex items-center">
                        <i class="fas fa-download mr-2"></i>下载二维码
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 批量导入弹窗 -->
    <div id="modal-import" class="modal">
        <div class="bg-white rounded-lg w-full max-w-3xl overflow-hidden shadow-2xl">
            <div class="flex items-center justify-between p-6 border-b bg-gray-50">
                <h2 class="text-xl font-bold text-gray-800">批量导入设备</h2>
                <button onclick="closeModal('import')" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6">
                <div class="mb-6">
                    <h3 class="font-semibold text-gray-800 mb-3">导入步骤</h3>
                    <ol class="list-decimal list-inside space-y-2 text-sm text-gray-600">
                        <li>下载Excel模板文件</li>
                        <li>按照模板格式填写设备信息</li>
                        <li>上传填写完成的Excel文件</li>
                        <li>系统自动校验并导入数据</li>
                    </ol>
                </div>
                <div class="mb-6">
                    <button onclick="downloadTemplate()" class="px-6 py-2 bg-success text-white rounded-lg hover:bg-green-700 transition-colors flex items-center">
                        <i class="fas fa-download mr-2"></i>下载Excel模板
                    </button>
                </div>
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                    <p class="text-gray-600 mb-4">拖拽文件到此处或点击上传</p>
                    <input type="file" id="import-file-input" accept=".xlsx,.xls" onchange="handleFileUpload(event)" style="display:none;">
                    <button onclick="document.getElementById('import-file-input').click()" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors">
                        选择文件
                    </button>
                </div>
            </div>
            <div class="flex justify-end gap-3 p-6 border-t bg-gray-50">
                <button onclick="closeModal('import')" class="px-6 py-2 border rounded-lg hover:bg-gray-100 transition-colors">取消</button>
                <button onclick="startImport()" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors">开始导入</button>
            </div>
        </div>
    </div>

    <script src="../../assets/js/equipment-asset-management.js"></script>
</body>
</html>
