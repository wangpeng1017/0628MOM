<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>规则配置器 - IOT平台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#1e40af',
                        'success': '#10b981',
                        'warning': '#f59e0b',
                        'danger': '#ef4444'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans">
    <div class="p-6">
        <!-- 页面头部 -->
        <div class="flex items-center justify-between mb-6">
            <div>
                <h1 class="text-2xl font-bold text-gray-800 mb-2">WHEN-IF-THEN 规则配置器</h1>
                <p class="text-gray-600">可视化规则配置 - 简单拖拽即可创建复杂业务规则</p>
            </div>
            <div class="flex space-x-3">
                <button onclick="testRule()" class="bg-warning text-white px-4 py-2 rounded-lg hover:bg-yellow-600">
                    <i class="fas fa-play mr-2"></i>测试规则
                </button>
                <button onclick="saveRule()" class="bg-success text-white px-4 py-2 rounded-lg hover:bg-green-700">
                    <i class="fas fa-save mr-2"></i>保存规则
                </button>
            </div>
        </div>

        <!-- 规则配置说明 -->
        <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg shadow-sm p-6 mb-6 border border-purple-200">
            <div class="flex items-start">
                <div class="w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center mr-4 flex-shrink-0">
                    <i class="fas fa-project-diagram text-white text-xl"></i>
                </div>
                <div class="flex-1">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">WHEN-IF-THEN 规则模型</h3>
                    <p class="text-sm text-gray-700 mb-3">通过三步配置创建智能规则：定义触发条件、判断条件和执行动作</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white rounded-lg p-3 border border-blue-100">
                            <div class="flex items-center mb-2">
                                <div class="w-8 h-8 bg-blue-600 rounded flex items-center justify-center mr-2">
                                    <span class="text-white font-bold text-xs">WHEN</span>
                                </div>
                                <h4 class="font-semibold text-gray-800 text-sm">触发条件</h4>
                            </div>
                            <p class="text-xs text-gray-600">定义什么时候触发规则</p>
                        </div>
                        <div class="bg-white rounded-lg p-3 border border-green-100">
                            <div class="flex items-center mb-2">
                                <div class="w-8 h-8 bg-green-600 rounded flex items-center justify-center mr-2">
                                    <span class="text-white font-bold text-xs">IF</span>
                                </div>
                                <h4 class="font-semibold text-gray-800 text-sm">判断条件</h4>
                            </div>
                            <p class="text-xs text-gray-600">满足什么条件才执行</p>
                        </div>
                        <div class="bg-white rounded-lg p-3 border border-orange-100">
                            <div class="flex items-center mb-2">
                                <div class="w-8 h-8 bg-orange-600 rounded flex items-center justify-center mr-2">
                                    <span class="text-white font-bold text-xs">THEN</span>
                                </div>
                                <h4 class="font-semibold text-gray-800 text-sm">执行动作</h4>
                            </div>
                            <p class="text-xs text-gray-600">触发后执行什么动作</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- WHEN 部分 -->
        <div class="border-2 border-blue-200 rounded-lg p-6 bg-blue-50 mb-6">
            <div class="flex items-center mb-4">
                <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center mr-3">
                    <span class="text-white font-bold">WHEN</span>
                </div>
                <div class="flex-1">
                    <h4 class="font-semibold text-gray-800">触发条件 (When)</h4>
                    <p class="text-xs text-gray-600">定义什么时候触发规则</p>
                </div>
                <button onclick="addWhenCondition()" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">
                    <i class="fas fa-plus mr-1"></i>添加条件
                </button>
            </div>
            <div id="whenConditions" class="space-y-3">
                <div class="bg-white rounded-lg p-4 border border-blue-200">
                    <div class="grid grid-cols-12 gap-3 items-center">
                        <div class="col-span-3">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>设备属性</option>
                                <option>设备事件</option>
                                <option>时间条件</option>
                                <option>外部数据</option>
                            </select>
                        </div>
                        <div class="col-span-3">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>逆变器-PV001</option>
                                <option>温度传感器-T001</option>
                                <option>智能电表-M001</option>
                            </select>
                        </div>
                        <div class="col-span-3">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>temperature (温度)</option>
                                <option>voltage (电压)</option>
                                <option>current (电流)</option>
                                <option>power (功率)</option>
                            </select>
                        </div>
                        <div class="col-span-2">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>数据到达</option>
                                <option>值变化</option>
                                <option>超过阈值</option>
                            </select>
                        </div>
                        <div class="col-span-1 text-center">
                            <button class="text-red-600 hover:text-red-800">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- IF 部分 -->
        <div class="border-2 border-green-200 rounded-lg p-6 bg-green-50 mb-6">
            <div class="flex items-center mb-4">
                <div class="w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center mr-3">
                    <span class="text-white font-bold">IF</span>
                </div>
                <div class="flex-1">
                    <h4 class="font-semibold text-gray-800">判断条件 (If)</h4>
                    <p class="text-xs text-gray-600">定义满足什么条件才执行动作</p>
                </div>
                <button onclick="addIfCondition()" class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700">
                    <i class="fas fa-plus mr-1"></i>添加条件
                </button>
            </div>
            <div id="ifConditions" class="space-y-3">
                <div class="bg-white rounded-lg p-4 border border-green-200">
                    <div class="grid grid-cols-12 gap-3 items-center">
                        <div class="col-span-3">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>temperature</option>
                                <option>voltage</option>
                                <option>current</option>
                                <option>power</option>
                            </select>
                        </div>
                        <div class="col-span-2">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>></option>
                                <option>>=</option>
                                <option><</option>
                                <option><=</option>
                                <option>==</option>
                                <option>!=</option>
                            </select>
                        </div>
                        <div class="col-span-3">
                            <input type="text" placeholder="阈值" class="w-full px-3 py-2 border border-gray-300 rounded text-sm" value="65">
                        </div>
                        <div class="col-span-2">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>AND</option>
                                <option>OR</option>
                            </select>
                        </div>
                        <div class="col-span-1 text-center">
                            <button class="text-red-600 hover:text-red-800">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg p-4 border border-green-200">
                    <div class="grid grid-cols-12 gap-3 items-center">
                        <div class="col-span-3">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>持续时间</option>
                                <option>连续次数</option>
                            </select>
                        </div>
                        <div class="col-span-2">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>>=</option>
                                <option>></option>
                            </select>
                        </div>
                        <div class="col-span-3">
                            <input type="text" placeholder="值" class="w-full px-3 py-2 border border-gray-300 rounded text-sm" value="5">
                        </div>
                        <div class="col-span-2">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>分钟</option>
                                <option>秒</option>
                                <option>次</option>
                            </select>
                        </div>
                        <div class="col-span-1 text-center">
                            <button class="text-red-600 hover:text-red-800">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- THEN 部分 -->
        <div class="border-2 border-orange-200 rounded-lg p-6 bg-orange-50 mb-6">
            <div class="flex items-center mb-4">
                <div class="w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center mr-3">
                    <span class="text-white font-bold">THEN</span>
                </div>
                <div class="flex-1">
                    <h4 class="font-semibold text-gray-800">执行动作 (Then)</h4>
                    <p class="text-xs text-gray-600">定义触发后执行什么动作</p>
                </div>
                <button onclick="addThenAction()" class="px-3 py-1 bg-orange-600 text-white rounded text-sm hover:bg-orange-700">
                    <i class="fas fa-plus mr-1"></i>添加动作
                </button>
            </div>
            <div id="thenActions" class="space-y-3">
                <div class="bg-white rounded-lg p-4 border border-orange-200">
                    <div class="grid grid-cols-12 gap-3 items-center">
                        <div class="col-span-3">
                            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm">
                                <option>发送告警</option>
                                <option>调用服务</option>
                                <option>发送通知</option>
                                <option>数据转发</option>
                                <option>执行脚本</option>
                            </select>
                        </div>
                        <div class="col-span-8">
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="text-xs text-gray-600">告警级别</label>
                                    <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm mt-1">
                                        <option>高</option>
                                        <option>中</option>
                                        <option>低</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-gray-600">通知方式</label>
                                    <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm mt-1">
                                        <option>邮件</option>
                                        <option>短信</option>
                                        <option>微信</option>
                                        <option>钉钉</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-span-1 text-center">
                            <button class="text-red-600 hover:text-red-800">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 规则预览 -->
        <div class="bg-white rounded-lg shadow-sm p-6">
            <h5 class="font-semibold text-gray-800 mb-3">规则预览</h5>
            <div class="bg-gray-900 rounded p-4">
                <pre class="text-xs text-green-400 font-mono">WHEN
  设备属性.逆变器-PV001.temperature 数据到达

IF
  temperature > 65
  AND 持续时间 >= 5 分钟

THEN
  发送告警 (级别: 高, 通知: 邮件)
  
规则名称: 涂覆机温度超限告警
优先级: 高
状态: 活跃</pre>
            </div>
        </div>
    </div>

    <script>
        function addWhenCondition() {
            alert('添加WHEN条件');
        }
        function addIfCondition() {
            alert('添加IF条件');
        }
        function addThenAction() {
            alert('添加THEN动作');
        }
        function testRule() {
            alert('测试规则');
        }
        function saveRule() {
            alert('保存规则');
        }
    </script>
</body>
</html>
