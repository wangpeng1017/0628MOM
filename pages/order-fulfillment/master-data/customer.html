<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>客户管理 - 订单履约</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .modal-backdrop {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .modal-enter {
            animation: modalEnter 0.3s ease-out;
        }

        @keyframes modalEnter {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(-20px);
            }

            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .toast {
            animation: toastSlide 0.3s ease-out;
        }

        @keyframes toastSlide {
            from {
                opacity: 0;
                transform: translateX(100%);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen">
    <div class="p-6">
        <!-- 面包屑 -->
        <nav class="flex items-center text-sm text-gray-500 mb-4">
            <a href="../index.html" class="hover:text-blue-600">订单履约</a>
            <i class="fas fa-chevron-right mx-2 text-xs"></i>
            <span class="text-gray-800 font-medium">客户管理</span>
        </nav>

        <!-- 标题 -->
        <div class="flex items-center justify-between mb-6">
            <div>
                <h1 class="text-2xl font-bold text-gray-800">客户管理</h1>
                <p class="text-gray-500 mt-1">管理客户信息、信用额度及交易记录</p>
            </div>
            <button onclick="openAddModal()"
                class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors">
                <i class="fas fa-plus mr-2"></i>新增客户
            </button>
        </div>

        <!-- 统计卡片 -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="glass-card rounded-xl p-5 border-l-4 border-blue-500 cursor-pointer hover:shadow-lg transition-shadow"
                onclick="filterByAll()">
                <div class="text-gray-500 text-sm">客户总数</div>
                <div class="text-2xl font-bold text-gray-800 mt-1" id="totalCount">156</div>
            </div>
            <div class="glass-card rounded-xl p-5 border-l-4 border-green-500 cursor-pointer hover:shadow-lg transition-shadow"
                onclick="filterByLevel('战略客户')">
                <div class="text-gray-500 text-sm">战略客户</div>
                <div class="text-2xl font-bold text-green-600 mt-1">28</div>
            </div>
            <div class="glass-card rounded-xl p-5 border-l-4 border-orange-500 cursor-pointer hover:shadow-lg transition-shadow"
                onclick="filterByStatus('活跃')">
                <div class="text-gray-500 text-sm">活跃客户(本月)</div>
                <div class="text-2xl font-bold text-orange-600 mt-1">89</div>
            </div>
            <div class="glass-card rounded-xl p-5 border-l-4 border-purple-500">
                <div class="text-gray-500 text-sm">本月新增</div>
                <div class="text-2xl font-bold text-purple-600 mt-1">12</div>
            </div>
        </div>

        <!-- 筛选 -->
        <div class="glass-card rounded-xl p-4 mb-6">
            <div class="flex flex-wrap items-center gap-4">
                <div class="relative flex-1 min-w-64">
                    <input type="text" id="searchInput" placeholder="搜索客户名称、编码或联系人..."
                        class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                        oninput="handleSearch()">
                    <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                </div>
                <select id="levelFilter"
                    class="px-4 py-2 border border-gray-200 rounded-lg text-sm text-gray-600 focus:ring-2 focus:ring-blue-500"
                    onchange="handleFilter()">
                    <option value="">客户级别</option>
                    <option value="战略客户">战略客户</option>
                    <option value="重要客户">重要客户</option>
                    <option value="普通客户">普通客户</option>
                </select>
                <select id="regionFilter"
                    class="px-4 py-2 border border-gray-200 rounded-lg text-sm text-gray-600 focus:ring-2 focus:ring-blue-500"
                    onchange="handleFilter()">
                    <option value="">区域</option>
                    <option value="华东">华东</option>
                    <option value="华北">华北</option>
                    <option value="华中">华中</option>
                    <option value="海外">海外</option>
                </select>
                <button onclick="resetFilters()"
                    class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg text-sm transition-colors">
                    <i class="fas fa-redo mr-1"></i>重置
                </button>
            </div>
        </div>

        <!-- 客户列表 -->
        <div class="glass-card rounded-xl overflow-hidden">
            <table class="w-full text-sm">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="text-left py-4 px-4 font-medium text-gray-600">客户信息</th>
                        <th class="text-left py-4 px-4 font-medium text-gray-600">联系人</th>
                        <th class="text-left py-4 px-4 font-medium text-gray-600">区域</th>
                        <th class="text-center py-4 px-4 font-medium text-gray-600">级别</th>
                        <th class="text-right py-4 px-4 font-medium text-gray-600">信用额度(¥)</th>
                        <th class="text-right py-4 px-4 font-medium text-gray-600">本年交易额(¥)</th>
                        <th class="text-center py-4 px-4 font-medium text-gray-600">状态</th>
                        <th class="text-center py-4 px-4 font-medium text-gray-600">操作</th>
                    </tr>
                </thead>
                <tbody id="customerTableBody" class="divide-y divide-gray-100">
                    <!-- 数据将通过JavaScript动态渲染 -->
                </tbody>
            </table>
            <div class="px-6 py-4 border-t border-gray-100 flex items-center justify-between">
                <div class="text-sm text-gray-500">共 <span id="displayCount" class="font-medium">156</span> 条记录</div>
                <div class="flex items-center space-x-2" id="pagination">
                    <!-- 分页将通过JavaScript动态渲染 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 新增/编辑客户模态框 -->
    <div id="customerModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop absolute inset-0" onclick="closeModal()"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4">
            <div class="modal-enter bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-100 flex items-center justify-between">
                    <h3 id="modalTitle" class="text-lg font-semibold text-gray-800">新增客户</h3>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="p-6 overflow-y-auto max-h-[calc(90vh-140px)]">
                    <form id="customerForm" onsubmit="handleSubmit(event)">
                        <input type="hidden" id="customerId">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">客户名称 <span
                                        class="text-red-500">*</span></label>
                                <input type="text" id="customerName" required
                                    class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">客户编码</label>
                                <input type="text" id="customerCode" placeholder="系统自动生成"
                                    class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm bg-gray-50"
                                    readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">联系人 <span
                                        class="text-red-500">*</span></label>
                                <input type="text" id="contactName" required
                                    class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">联系电话 <span
                                        class="text-red-500">*</span></label>
                                <input type="tel" id="contactPhone" required
                                    class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">客户级别</label>
                                <select id="customerLevel"
                                    class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="普通客户">普通客户</option>
                                    <option value="重要客户">重要客户</option>
                                    <option value="战略客户">战略客户</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">区域</label>
                                <select id="customerRegion"
                                    class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="华东">华东</option>
                                    <option value="华北">华北</option>
                                    <option value="华中">华中</option>
                                    <option value="华南">华南</option>
                                    <option value="海外">海外</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">信用额度(¥)</label>
                                <input type="number" id="creditLimit" min="0" step="1000000" value="10000000"
                                    class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">状态</label>
                                <select id="customerStatus"
                                    class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="活跃">活跃</option>
                                    <option value="休眠">休眠</option>
                                    <option value="冻结">冻结</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">备注</label>
                            <textarea id="customerRemark" rows="3"
                                class="w-full px-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                        </div>
                    </form>
                </div>
                <div class="px-6 py-4 border-t border-gray-100 flex justify-end space-x-3">
                    <button onclick="closeModal()"
                        class="px-4 py-2 border border-gray-200 text-gray-600 rounded-lg hover:bg-gray-50 text-sm transition-colors">取消</button>
                    <button onclick="handleSubmit(event)"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm transition-colors">
                        <i class="fas fa-check mr-1"></i>保存
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 查看详情模态框 -->
    <div id="detailModal" class="fixed inset-0 z-50 hidden">
        <div class="modal-backdrop absolute inset-0" onclick="closeDetailModal()"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4">
            <div class="modal-enter bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-100 flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-gray-800">客户详情</h3>
                    <button onclick="closeDetailModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="p-6 overflow-y-auto max-h-[calc(90vh-80px)]" id="detailContent">
                    <!-- 详情内容将动态渲染 -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast 提示 -->
    <div id="toast" class="fixed top-4 right-4 z-50 hidden">
        <div class="toast bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span id="toastMessage">操作成功</span>
        </div>
    </div>

    <script>
        // 模拟客户数据
        let customers = [
            { id: 1, name: '韩国现代电气', code: 'C-2024001', contact: '金东仁', phone: '+82-10-1234-5678', region: '海外-韩国', level: '战略客户', credit: 50000000, transaction: 38500000, status: '活跃', color: 'blue' },
            { id: 2, name: '国家电投集团', code: 'C-2024002', contact: '王明轩', phone: '139-0000-0001', region: '华北-北京', level: '战略客户', credit: 100000000, transaction: 72800000, status: '活跃', color: 'green' },
            { id: 3, name: '三峡新能源', code: 'C-2024003', contact: '李建国', phone: '138-0000-0002', region: '华中-湖北', level: '重要客户', credit: 30000000, transaction: 18200000, status: '活跃', color: 'orange' },
            { id: 4, name: '巴西Solar Tech', code: 'C-2024004', contact: 'Carlos Silva', phone: '+55-11-9876-5432', region: '海外-巴西', level: '重要客户', credit: 20000000, transaction: 8700000, status: '活跃', color: 'purple' },
            { id: 5, name: '上海电气风电', code: 'C-2024005', contact: '赵德明', phone: '137-0000-0003', region: '华东-上海', level: '普通客户', credit: 10000000, transaction: 5850000, status: '活跃', color: 'cyan' },
            { id: 6, name: '华能集团', code: 'C-2024006', contact: '刘志强', phone: '136-0000-0004', region: '华北-北京', level: '战略客户', credit: 80000000, transaction: 45000000, status: '活跃', color: 'blue' },
            { id: 7, name: '日本丸红株式会社', code: 'C-2024007', contact: '田中太郎', phone: '+81-3-1234-5678', region: '海外-日本', level: '重要客户', credit: 40000000, transaction: 22000000, status: '休眠', color: 'red' },
        ];

        let filteredCustomers = [...customers];
        let currentPage = 1;
        const pageSize = 5;

        // 初始化
        document.addEventListener('DOMContentLoaded', function () {
            renderTable();
            renderPagination();
        });

        // 渲染表格
        function renderTable() {
            const tbody = document.getElementById('customerTableBody');
            const start = (currentPage - 1) * pageSize;
            const end = start + pageSize;
            const pageData = filteredCustomers.slice(start, end);

            if (pageData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="py-12 text-center text-gray-500">
                            <i class="fas fa-inbox text-4xl mb-3 block text-gray-300"></i>
                            暂无数据
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = pageData.map(customer => `
                <tr class="hover:bg-gray-50 transition-colors">
                    <td class="py-4 px-4">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-${customer.color}-100 rounded-full flex items-center justify-center mr-3">
                                <span class="text-${customer.color}-700 font-medium">${customer.name.charAt(0)}</span>
                            </div>
                            <div>
                                <div class="font-medium text-gray-800">${customer.name}</div>
                                <div class="text-xs text-gray-500">${customer.code}</div>
                            </div>
                        </div>
                    </td>
                    <td class="py-4 px-4">
                        <div class="text-gray-800">${customer.contact}</div>
                        <div class="text-xs text-gray-500">${customer.phone}</div>
                    </td>
                    <td class="py-4 px-4 text-gray-600">${customer.region}</td>
                    <td class="py-4 px-4 text-center">
                        <span class="px-2 py-1 ${getLevelStyle(customer.level)} rounded-full text-xs">${customer.level}</span>
                    </td>
                    <td class="py-4 px-4 text-right font-medium">${formatNumber(customer.credit)}</td>
                    <td class="py-4 px-4 text-right text-blue-600 font-medium">${formatNumber(customer.transaction)}</td>
                    <td class="py-4 px-4 text-center">
                        <span class="px-2 py-1 ${getStatusStyle(customer.status)} rounded-full text-xs">${customer.status}</span>
                    </td>
                    <td class="py-4 px-4 text-center">
                        <button onclick="viewDetail(${customer.id})" class="p-1.5 text-gray-400 hover:text-blue-600 transition-colors" title="查看详情">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button onclick="editCustomer(${customer.id})" class="p-1.5 text-gray-400 hover:text-blue-600 transition-colors" title="编辑">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deleteCustomer(${customer.id})" class="p-1.5 text-gray-400 hover:text-red-600 transition-colors" title="删除">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');

            document.getElementById('displayCount').textContent = filteredCustomers.length;
        }

        // 渲染分页
        function renderPagination() {
            const totalPages = Math.ceil(filteredCustomers.length / pageSize);
            const pagination = document.getElementById('pagination');

            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            let html = `<button onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''} class="px-3 py-1 border border-gray-200 rounded text-gray-500 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors"><i class="fas fa-chevron-left"></i></button>`;

            for (let i = 1; i <= totalPages; i++) {
                if (i === currentPage) {
                    html += `<button class="px-3 py-1 bg-blue-600 text-white rounded text-sm">${i}</button>`;
                } else {
                    html += `<button onclick="goToPage(${i})" class="px-3 py-1 border border-gray-200 rounded text-gray-600 text-sm hover:bg-gray-50 transition-colors">${i}</button>`;
                }
            }

            html += `<button onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''} class="px-3 py-1 border border-gray-200 rounded text-gray-500 text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors"><i class="fas fa-chevron-right"></i></button>`;

            pagination.innerHTML = html;
        }

        // 分页跳转
        function goToPage(page) {
            const totalPages = Math.ceil(filteredCustomers.length / pageSize);
            if (page < 1 || page > totalPages) return;
            currentPage = page;
            renderTable();
            renderPagination();
        }

        // 搜索
        function handleSearch() {
            const keyword = document.getElementById('searchInput').value.toLowerCase();
            applyFilters();
        }

        // 筛选
        function handleFilter() {
            applyFilters();
        }

        // 应用筛选
        function applyFilters() {
            const keyword = document.getElementById('searchInput').value.toLowerCase();
            const levelFilter = document.getElementById('levelFilter').value;
            const regionFilter = document.getElementById('regionFilter').value;

            filteredCustomers = customers.filter(customer => {
                const matchKeyword = !keyword ||
                    customer.name.toLowerCase().includes(keyword) ||
                    customer.code.toLowerCase().includes(keyword) ||
                    customer.contact.toLowerCase().includes(keyword);
                const matchLevel = !levelFilter || customer.level === levelFilter;
                const matchRegion = !regionFilter || customer.region.includes(regionFilter);
                return matchKeyword && matchLevel && matchRegion;
            });

            currentPage = 1;
            renderTable();
            renderPagination();
        }

        // 重置筛选
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('levelFilter').value = '';
            document.getElementById('regionFilter').value = '';
            filteredCustomers = [...customers];
            currentPage = 1;
            renderTable();
            renderPagination();
        }

        // 按级别筛选
        function filterByLevel(level) {
            document.getElementById('levelFilter').value = level;
            applyFilters();
        }

        // 按状态筛选
        function filterByStatus(status) {
            filteredCustomers = customers.filter(c => c.status === status);
            currentPage = 1;
            renderTable();
            renderPagination();
        }

        // 显示全部
        function filterByAll() {
            resetFilters();
        }

        // 打开新增模态框
        function openAddModal() {
            document.getElementById('modalTitle').textContent = '新增客户';
            document.getElementById('customerForm').reset();
            document.getElementById('customerId').value = '';
            document.getElementById('customerCode').value = 'C-' + new Date().getFullYear() + String(customers.length + 1).padStart(3, '0');
            document.getElementById('customerModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // 编辑客户
        function editCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (!customer) return;

            document.getElementById('modalTitle').textContent = '编辑客户';
            document.getElementById('customerId').value = customer.id;
            document.getElementById('customerName').value = customer.name;
            document.getElementById('customerCode').value = customer.code;
            document.getElementById('contactName').value = customer.contact;
            document.getElementById('contactPhone').value = customer.phone;
            document.getElementById('customerLevel').value = customer.level;
            document.getElementById('customerRegion').value = customer.region.split('-')[0];
            document.getElementById('creditLimit').value = customer.credit;
            document.getElementById('customerStatus').value = customer.status;
            document.getElementById('customerModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // 关闭模态框
        function closeModal() {
            document.getElementById('customerModal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        // 提交表单
        function handleSubmit(event) {
            event.preventDefault();
            const id = document.getElementById('customerId').value;
            const customerData = {
                name: document.getElementById('customerName').value,
                code: document.getElementById('customerCode').value,
                contact: document.getElementById('contactName').value,
                phone: document.getElementById('contactPhone').value,
                level: document.getElementById('customerLevel').value,
                region: document.getElementById('customerRegion').value,
                credit: parseInt(document.getElementById('creditLimit').value),
                status: document.getElementById('customerStatus').value,
                color: ['blue', 'green', 'orange', 'purple', 'cyan', 'red'][Math.floor(Math.random() * 6)]
            };

            if (id) {
                // 编辑
                const index = customers.findIndex(c => c.id === parseInt(id));
                if (index !== -1) {
                    customers[index] = { ...customers[index], ...customerData };
                    showToast('客户信息已更新');
                }
            } else {
                // 新增
                customerData.id = customers.length + 1;
                customerData.transaction = 0;
                customers.unshift(customerData);
                showToast('客户添加成功');
            }

            closeModal();
            applyFilters();
        }

        // 查看详情
        function viewDetail(id) {
            const customer = customers.find(c => c.id === id);
            if (!customer) return;

            document.getElementById('detailContent').innerHTML = `
                <div class="flex items-start mb-6">
                    <div class="w-16 h-16 bg-${customer.color}-100 rounded-xl flex items-center justify-center mr-4">
                        <span class="text-${customer.color}-700 font-bold text-2xl">${customer.name.charAt(0)}</span>
                    </div>
                    <div>
                        <h4 class="text-xl font-bold text-gray-800">${customer.name}</h4>
                        <p class="text-gray-500">${customer.code}</p>
                        <span class="inline-block mt-1 px-2 py-1 ${getLevelStyle(customer.level)} rounded-full text-xs">${customer.level}</span>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="text-sm text-gray-500 mb-1">联系人</div>
                        <div class="font-medium text-gray-800">${customer.contact}</div>
                        <div class="text-sm text-blue-600">${customer.phone}</div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="text-sm text-gray-500 mb-1">区域</div>
                        <div class="font-medium text-gray-800">${customer.region}</div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="text-sm text-gray-500 mb-1">信用额度</div>
                        <div class="font-medium text-gray-800">¥${formatNumber(customer.credit)}</div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <div class="text-sm text-gray-500 mb-1">本年交易额</div>
                        <div class="font-medium text-blue-600">¥${formatNumber(customer.transaction)}</div>
                    </div>
                </div>
                <div class="border-t border-gray-200 pt-4">
                    <h5 class="font-semibold text-gray-800 mb-3">最近订单</h5>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <span class="font-medium text-blue-600">SO-2026010601</span>
                                <span class="text-gray-500 text-sm ml-2">CPS SCA100KTL × 500台</span>
                            </div>
                            <span class="text-green-600 text-sm">¥14,000,000</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <span class="font-medium text-blue-600">SO-2025123156</span>
                                <span class="text-gray-500 text-sm ml-2">CPS SCA225KTL × 150台</span>
                            </div>
                            <span class="text-green-600 text-sm">¥5,850,000</span>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('detailModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // 关闭详情模态框
        function closeDetailModal() {
            document.getElementById('detailModal').classList.add('hidden');
            document.body.style.overflow = '';
        }

        // 删除客户
        function deleteCustomer(id) {
            if (confirm('确定要删除该客户吗？此操作不可恢复。')) {
                customers = customers.filter(c => c.id !== id);
                applyFilters();
                showToast('客户已删除');
            }
        }

        // 显示提示
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastDiv = toast.querySelector('div');
            document.getElementById('toastMessage').textContent = message;

            toastDiv.className = `toast ${type === 'success' ? 'bg-green-500' : 'bg-red-500'} text-white px-6 py-3 rounded-lg shadow-lg flex items-center`;
            toast.classList.remove('hidden');

            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }

        // 辅助函数
        function getLevelStyle(level) {
            const styles = {
                '战略客户': 'bg-red-100 text-red-700',
                '重要客户': 'bg-orange-100 text-orange-700',
                '普通客户': 'bg-gray-100 text-gray-600'
            };
            return styles[level] || 'bg-gray-100 text-gray-600';
        }

        function getStatusStyle(status) {
            const styles = {
                '活跃': 'bg-green-100 text-green-700',
                '休眠': 'bg-yellow-100 text-yellow-700',
                '冻结': 'bg-red-100 text-red-700'
            };
            return styles[status] || 'bg-gray-100 text-gray-600';
        }

        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        // ESC键关闭模态框
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closeModal();
                closeDetailModal();
            }
        });
    </script>
</body>

</html>