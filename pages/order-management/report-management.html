<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>报表管理系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-50">
    <div class="p-6">
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
            <h1 class="text-2xl font-bold text-gray-800 mb-2">报表管理系统</h1>
            <p class="text-sm text-gray-600">可视化报表设计、多维度查询分析、图表展示</p>
        </div>

        <!-- 报表模板设计 -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
            <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-file-alt text-blue-600 mr-2"></i>报表模板设计
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <button onclick="openTemplate('sales')" class="p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-all">
                    <i class="fas fa-shopping-cart text-3xl text-blue-600 mb-2"></i>
                    <h3 class="font-semibold text-gray-800">销售订单报表</h3>
                    <p class="text-xs text-gray-500 mt-1">订单数量、金额、状态统计</p>
                </button>
                <button onclick="openTemplate('delivery')" class="p-4 border-2 border-gray-200 rounded-lg hover:border-green-500 hover:bg-green-50 transition-all">
                    <i class="fas fa-truck text-3xl text-green-600 mb-2"></i>
                    <h3 class="font-semibold text-gray-800">交货单报表</h3>
                    <p class="text-xs text-gray-500 mt-1">交付进度、延迟分析</p>
                </button>
                <button onclick="openTemplate('ot')" class="p-4 border-2 border-gray-200 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-all">
                    <i class="fas fa-clock text-3xl text-purple-600 mb-2"></i>
                    <h3 class="font-semibold text-gray-800">OT表报表</h3>
                    <p class="text-xs text-gray-500 mt-1">加班工时、成本统计</p>
                </button>
            </div>
        </div>

        <!-- 多维度查询 -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
            <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                <i class="fas fa-search text-green-600 mr-2"></i>多维度查询分析
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">订单号</label>
                    <input type="text" id="orderNo" placeholder="ORD-2024-001" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">客户名称</label>
                    <input type="text" id="customerName" placeholder="韩国现代" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">产品型号</label>
                    <input type="text" id="productModel" placeholder="INV-5000" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">开始时间</label>
                    <input type="date" id="startDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">结束时间</label>
                    <input type="date" id="endDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">订单状态</label>
                    <select id="orderStatus" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                        <option value="">全部状态</option>
                        <option value="pending">待审核</option>
                        <option value="executing">执行中</option>
                        <option value="completed">已完成</option>
                        <option value="shipped">已发货</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">公司范围</label>
                    <select id="companyScope" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                        <option value="all">跨公司合并</option>
                        <option value="hq">总部</option>
                        <option value="branch1">分公司1</option>
                        <option value="branch2">分公司2</option>
                    </select>
                </div>
                <div class="flex items-end">
                    <button onclick="queryReport()" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-search mr-2"></i>查询
                    </button>
                </div>
                <div class="flex items-end">
                    <button onclick="resetQuery()" class="w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                        <i class="fas fa-redo mr-2"></i>重置
                    </button>
                </div>
            </div>
        </div>

        <!-- 数据分析图表 -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-gray-800 flex items-center">
                    <i class="fas fa-chart-bar text-purple-600 mr-2"></i>可视化数据分析
                </h2>
                <div class="flex space-x-2">
                    <button onclick="switchChart('bar')" class="px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200">
                        <i class="fas fa-chart-bar mr-1"></i>柱状图
                    </button>
                    <button onclick="switchChart('line')" class="px-3 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200">
                        <i class="fas fa-chart-line mr-1"></i>折线图
                    </button>
                    <button onclick="switchChart('pie')" class="px-3 py-1 bg-purple-100 text-purple-700 rounded hover:bg-purple-200">
                        <i class="fas fa-chart-pie mr-1"></i>饼图
                    </button>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div style="height: 300px;">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">订单金额趋势分析</h3>
                    <div style="height: 250px; position: relative;">
                        <canvas id="amountChart"></canvas>
                    </div>
                </div>
                <div style="height: 300px;">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">订单状态分布</h3>
                    <div style="height: 250px; position: relative;">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- 报表数据展示 -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200">
            <div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
                <h2 class="text-lg font-semibold text-gray-800">报表数据明细</h2>
                <div class="flex space-x-2">
                    <button onclick="exportExcel()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                        <i class="fas fa-file-excel mr-2"></i>导出Excel
                    </button>
                    <button onclick="exportPDF()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">
                        <i class="fas fa-file-pdf mr-2"></i>导出PDF
                    </button>
                    <button onclick="printReport()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                        <i class="fas fa-print mr-2"></i>打印
                    </button>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">订单号</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">客户名称</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">产品型号</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">数量</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">金额</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">创建时间</th>
                            <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">状态</th>
                        </tr>
                    </thead>
                    <tbody id="reportTableBody">
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-001</td><td class="px-6 py-4">隆基绿能科技股份</td><td class="px-6 py-4">INV-5000</td><td class="px-6 py-4">120台</td><td class="px-6 py-4 font-semibold">¥125,800</td><td class="px-6 py-4">2024-10-25</td><td class="px-6 py-4"><span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs">待审核</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-002</td><td class="px-6 py-4">国家电投</td><td class="px-6 py-4">INV-3000</td><td class="px-6 py-4">85台</td><td class="px-6 py-4 font-semibold">¥89,600</td><td class="px-6 py-4">2024-10-24</td><td class="px-6 py-4"><span class="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">执行中</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-003</td><td class="px-6 py-4">三峡集团</td><td class="px-6 py-4">INV-8000</td><td class="px-6 py-4">180台</td><td class="px-6 py-4 font-semibold">¥203,400</td><td class="px-6 py-4">2024-10-23</td><td class="px-6 py-4"><span class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">已完成</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-004</td><td class="px-6 py-4">上海电气</td><td class="px-6 py-4">INV-6000</td><td class="px-6 py-4">145台</td><td class="px-6 py-4 font-semibold">¥156,900</td><td class="px-6 py-4">2024-10-22</td><td class="px-6 py-4"><span class="px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs">已发货</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-005</td><td class="px-6 py-4">天合光能股份有限公司</td><td class="px-6 py-4">INV-4000</td><td class="px-6 py-4">68台</td><td class="px-6 py-4 font-semibold">¥78,500</td><td class="px-6 py-4">2024-10-21</td><td class="px-6 py-4"><span class="px-2 py-1 bg-cyan-100 text-cyan-800 rounded text-xs">已送达</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-006</td><td class="px-6 py-4">晶科能源股份有限公司</td><td class="px-6 py-4">INV-7000</td><td class="px-6 py-4">175台</td><td class="px-6 py-4 font-semibold">¥198,700</td><td class="px-6 py-4">2024-10-20</td><td class="px-6 py-4"><span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs">待审核</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-007</td><td class="px-6 py-4">阿特斯阳光电力集团</td><td class="px-6 py-4">INV-5500</td><td class="px-6 py-4">125台</td><td class="px-6 py-4 font-semibold">¥134,200</td><td class="px-6 py-4">2024-10-19</td><td class="px-6 py-4"><span class="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">执行中</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-008</td><td class="px-6 py-4">正泰集团股份有限公司</td><td class="px-6 py-4">INV-6500</td><td class="px-6 py-4">155台</td><td class="px-6 py-4 font-semibold">¥167,800</td><td class="px-6 py-4">2024-10-18</td><td class="px-6 py-4"><span class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">已完成</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-009</td><td class="px-6 py-4">协鑫集成科技股份</td><td class="px-6 py-4">INV-5200</td><td class="px-6 py-4">135台</td><td class="px-6 py-4 font-semibold">¥145,300</td><td class="px-6 py-4">2024-10-17</td><td class="px-6 py-4"><span class="px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs">已发货</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-010</td><td class="px-6 py-4">东方日升新能源</td><td class="px-6 py-4">INV-4500</td><td class="px-6 py-4">98台</td><td class="px-6 py-4 font-semibold">¥112,600</td><td class="px-6 py-4">2024-10-16</td><td class="px-6 py-4"><span class="px-2 py-1 bg-cyan-100 text-cyan-800 rounded text-xs">已送达</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-011</td><td class="px-6 py-4">中国电建集团</td><td class="px-6 py-4">INV-9000</td><td class="px-6 py-4">265台</td><td class="px-6 py-4 font-semibold">¥289,500</td><td class="px-6 py-4">2024-10-15</td><td class="px-6 py-4"><span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs">待审核</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-012</td><td class="px-6 py-4">国家电网公司</td><td class="px-6 py-4">INV-10000</td><td class="px-6 py-4">320台</td><td class="px-6 py-4 font-semibold">¥356,800</td><td class="px-6 py-4">2024-10-14</td><td class="px-6 py-4"><span class="px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs">执行中</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-013</td><td class="px-6 py-4">南方电网公司</td><td class="px-6 py-4">INV-8500</td><td class="px-6 py-4">275台</td><td class="px-6 py-4 font-semibold">¥298,400</td><td class="px-6 py-4">2024-10-13</td><td class="px-6 py-4"><span class="px-2 py-1 bg-green-100 text-green-800 rounded text-xs">已完成</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-014</td><td class="px-6 py-4">中广核新能源</td><td class="px-6 py-4">INV-7200</td><td class="px-6 py-4">168台</td><td class="px-6 py-4 font-semibold">¥187,900</td><td class="px-6 py-4">2024-10-12</td><td class="px-6 py-4"><span class="px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs">已发货</span></td></tr>
                        <tr class="border-t hover:bg-gray-50"><td class="px-6 py-4 font-medium text-blue-600">ORD-2024-015</td><td class="px-6 py-4">三峡新能源</td><td class="px-6 py-4">INV-8200</td><td class="px-6 py-4">215台</td><td class="px-6 py-4 font-semibold">¥234,600</td><td class="px-6 py-4">2024-10-11</td><td class="px-6 py-4"><span class="px-2 py-1 bg-cyan-100 text-cyan-800 rounded text-xs">已送达</span></td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let amountChart, statusChart;

        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
        });

        function initCharts() {
            const amountCtx = document.getElementById('amountChart');
            const statusCtx = document.getElementById('statusChart');
            
            if (!amountCtx || !statusCtx) return;
            
            amountChart = new Chart(amountCtx, {
                type: 'bar',
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                    datasets: [{
                        label: '订单金额(万元)',
                        data: [245, 268, 285, 298, 275, 320],
                        backgroundColor: '#3b82f6',
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true }
                    }
                }
            });

            statusChart = new Chart(statusCtx, {
                type: 'pie',
                data: {
                    labels: ['待审核', '执行中', '已完成', '已发货', '已送达'],
                    datasets: [{
                        data: [3, 3, 3, 3, 3],
                        backgroundColor: ['#f59e0b', '#3b82f6', '#10b981', '#8b5cf6', '#06b6d4']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        function switchChart(type) {
            if (amountChart) {
                amountChart.destroy();
            }
            const ctx = document.getElementById('amountChart');
            if (!ctx) return;
            
            amountChart = new Chart(ctx, {
                type: type,
                data: {
                    labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                    datasets: [{
                        label: '订单金额(万元)',
                        data: [245, 268, 285, 298, 275, 320],
                        backgroundColor: type === 'line' ? 'transparent' : '#3b82f6',
                        borderColor: '#3b82f6',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: type === 'line' ? false : true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true }
                    }
                }
            });
        }

        function openTemplate(type) {
            const templates = {
                sales: 'order-statistics.html',
                delivery: 'delivery-report.html',
                ot: 'ot-report.html'
            };
            parent.navigateToModule('order-management');
            setTimeout(() => {
                parent.navigateToDocumentPage('order-management', `pages/order-management/${templates[type]}`, '报表详情');
            }, 100);
        }

        function queryReport() {
            alert('查询功能已触发\n订单号: ' + document.getElementById('orderNo').value + '\n客户: ' + document.getElementById('customerName').value);
        }

        function resetQuery() {
            document.getElementById('orderNo').value = '';
            document.getElementById('customerName').value = '';
            document.getElementById('productModel').value = '';
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';
            document.getElementById('orderStatus').value = '';
            document.getElementById('companyScope').value = 'all';
        }

        function exportExcel() {
            alert('正在导出Excel报表...');
        }

        function exportPDF() {
            alert('正在导出PDF报表...');
        }

        function printReport() {
            window.print();
        }
    </script>
</body>
</html>
