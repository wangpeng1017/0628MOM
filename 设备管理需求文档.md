## **第四部分：业务流程与功能描述**

### **4.1 设备资产管理**
设备资产管理是整个系统的基石。我们的设计理念是为每一台设备构建一个从“出生”到“消亡”的、信息完整、动态更新的**“数字孪生档案”**，它不仅是静态信息的集合，更是所有动态业务事件的数据载体。

#### **4.1.1 设备台账管理**

##### **详细功能阐述**

1.  **全生命周期电子档案：** 我们将为正泰的每一台设备（从大型生产设备到精密仪器、工装夹具）建立唯一、全面的电子档案。此档案的核心是**动静分离**的数据模型。
    *   **静态属性：** 一经录入基本不变的信息，如设备原始编码、型号规格、制造商、采购日期、原值、设计技术参数（如额定功率、最大转速）等。这部分信息确保了设备身份的唯一性和历史可追溯性。
    *   **动态属性：** 经常变化的信息，如**当前状态**（在用、停机、维修中、保养中、待报废等）、**当前位置**（精确到产线工位）、累计运行时长、当前责任人、净值等。每一次动态属性的变更，系统都会自动记录日志，形成不可篡改的“履历”。

2.  **多维度树形结构与视图：** 为了满足不同部门的管理视角，系统不仅支持按**“物理位置”**（公司-车间-产线-设备）构建的层级树，还支持按**“功能类别”**（如动力设备、测试设备、装配设备）或**“设备系统”**（如某大型设备下的液压系统、控制系统、机械臂等）构建虚拟的树形结构。用户可以方便地在不同维度的视图间切换，快速找到和管理目标设备。

3.  **二维码/RFID深度集成与应用：** 我们不仅仅是为设备贴一个标签，更是将二维码/RFID作为连接**物理世界**与**数字世界**的桥梁。
    *   **一物一码：** 系统为每个设备资产（包括重要部件）自动生成唯一的二维码，支持批量打印和标签设计。
    *   **扫码即服务：** 现场任何人员（操作员、维修工、点检员）通过移动端APP扫描设备二维码，即可触发一个场景化的菜单，例如：
        *   **操作员：** [查看SOP] [发起报修] [查看设备状态]
        *   **维修工：** [接收工单] [查看历史维修] [领用备件] [完工反馈]
        *   **点检员：** [开始点检] [记录数据] [上报异常]
    *   这种设计极大地降低了APP的使用门槛，提升了现场工作的效率和数据的准确性。

4.  **强大的附件与文档管理：** 支持上传任意格式的设备相关文档（CAD图纸、PDF说明书、Office文档、图片、视频），并与设备档案强关联。系统内置**版本控制**机制，确保所有人访问的都是最新版本的文档。同时，通过**权限控制**，可设定不同角色对文档的查看、下载、修改权限，保证技术资料的安全。

5.  **智能化数据导入与校验：** 为方便期初海量设备数据的初始化，系统提供标准的Excel导入模板。导入过程中，系统后台会自动进行**数据校验**（如日期格式、必填项、编码唯一性等），对于校验失败的数据会生成详细的错误报告，提示用户修改后重新导入，从而保证了基础数据的质量。

6.  **灵活的自定义字段引擎：** 我们深知标准化产品无法满足所有个性化需求。系统的低代码平台允许管理员**无需编程**，即可为不同类别的设备动态添加自定义管理字段（如文本、数字、日期、下拉菜单等）。这些自定义字段会自动融入到设备的查询、统计和报表功能中，具备与原生字段同等的功能。

##### **业务流程**

**流程一：新设备入账与启用流程**

*   **场景：** 一台新的自动光学检测（AOI）设备采购到货，需要完成从入库、安装调试到正式启用的全过程信息记录。
*   **参与角色：** 资产管理员、安装工程师、生产主管。
*   **流程步骤：**
    1.  **【创建预入账记录 - PC端】**：资产管理员在PC端“设备台账”模块，点击“新建设备”。依据采购合同和到货清单，录入设备型号、制造商、原值等静态信息，此时设备状态为“待安装”。
    2.  **【生成与绑定标识】**：系统自动生成唯一的设备编码和二维码。资产管理员打印出二维码标签，交由工程师。
    3.  **【现场安装与信息完善 - 移动端】**：安装工程师在光储智能制造基地的指定产线完成设备安装。
    4.  **【扫码激活档案】**：工程师打开手机APP，扫描贴在设备上的二维码。系统自动定位到该设备的预入账档案。
    5.  **【更新动态信息】**：工程师在APP上更新信息：
        *   **安装位置：** 通过选择“A车间 -> B产线 -> 封装工位”，精确定位。
        *   **上传附件：** 拍摄设备安装完成后的现场照片、上传安装调试报告和验收单。
        *   **更新状态：** 将设备状态由“待安装”修改为“待验收”。
    6.  **【审核与启用 - PC/移动端】**：生产主管收到系统推送的“设备待验收”通知。他到现场检查设备，确认无误后，在系统中进行“验收通过”操作。
    7.  **【流程闭环】**：系统自动将设备状态更新为“在用”，并记录启用日期。至此，该设备的电子档案正式建立，所有操作历史均被记录在设备履历中。

**【请在此处插入新设备入账与启用业务流程图】**

##### **功能架构**

*   **前端：**
    *   **设备管理界面模块：**
        *   **设备树组件：** 负责展示和操作多维度树形结构。
        *   **设备列表组件：** 使用数据表格，实现设备的查询、筛选、排序、批量操作。
        *   **设备详情组件：** Tab页布局，聚合展示设备所有信息。
        *   **表单生成器组件：** 根据后端返回的设备模型定义（含自定义字段），动态渲染设备新建/编辑表单。
*   **后端微服务：**
    *   **资产管理服务：**
        *   **接口层：** 提供设备增删改查、树结构获取、履历记录等RESTful API。
        *   **业务逻辑层：** 实现设备编码生成规则、设备履历自动记录、状态机管理、与其它服务的业务编排。
    *   **系统管理服务：**
        *   **接口层：** 提供自定义字段元数据的管理API。
    *   **文件存储服务：**
        *   **接口层：** 提供文件上传、下载的API，可对接MinIO等对象存储。
*   **数据层：**
    *   **设备主表：** 存储设备核心信息。
    *   **设备履历表：** 记录每一次变更。
    *   **设备自定义字段值表：** 存储自定义字段的数据。
    *   **设备附件表：** 管理设备关联的文档信息。

---

### **4.2 维护维修管理**
维护维修管理是提升设备可靠性、降低停机损失的核心模块。我们的设计理念是构建一个从**故障发生**到**问题根除**的**全闭环、数据驱动、知识沉淀**的管理体系。

#### **4.2.1 故障报修到验收关闭全流程**

##### **详细功能阐述**

1.  **多渠道、便捷化的故障报修入口：**
    *   **移动端扫码报修：** 主推方式。操作员用手机APP扫描设备二维码，系统自动带出设备信息，操作员只需选择故障现象（可预设常见故障列表）、拍照/录短视频上传，即可完成报修。
    *   **PC端报修：** 适用于中控室或办公室人员，提供更详细的信息录入界面。
    *   **设备自诊断触发（集成IoT）：** 对于已联网的智能化设备，当设备自诊断系统发现故障代码时，可通过API自动向本系统创建报修单，实现“机器报修”。

2.  **智能化、可视化的工单调度与派发：**
    *   **维修工作台：** 维修主管或计划员拥有一个可视化的工作台，以看板（Kanban）或列表形式，清晰展示所有待处理、进行中、已完成的报修请求。
    *   **智能辅助派单：** 系统可根据预设规则提供派单建议。规则可基于技能矩阵、区域负责制、或工程师负载。
    *   **手动派单与抢单模式：** 主管可手动指定维修人员，也支持将工单发布到工单池，由具备资质的工程师“抢单”。

3.  **全过程、移动化的工单执行与反馈：**
    *   **消息推送到APP：** 新工单通过APP消息推送给工程师，点击即可查看详情。
    *   **工单状态流转：** 工程师在APP上更新工单状态：[接受任务] -> [出发] -> [开始维修] -> [暂停（待料）] -> [完成维修]。每一次状态变更，系统自动记录时间戳。
    *   **结构化维修报告：** 完工时，工程师需填写结构化的报告，包括：故障根本原因分析(RCA)、处理措施、更换的备件（可扫码领用）、维修后测试结果等。

4.  **严格、灵活的验收确认与评价机制：**
    *   **多角色验收：** 可设置灵活的验收流程，支持报修人、生产主管、设备工程师等多方共同确认。
    *   **验收标准与检查表：** 对重要维修，可在工单中附带验收检查表，验收人需逐项确认。
    *   **维修效果评价：** 验收通过后，报修人可以对本次维修的响应速度、维修质量进行评分和评价，作为维修团队绩效考核的数据参考。

##### **业务流程**

*   **场景：** 生产过程中，一台关键的贴片机出现报警停机，操作员需要报修，直至设备恢复正常生产。
*   **参与角色：** 产线操作员、维修主管、电气工程师、生产班长。
*   **流程步骤：**
    1.  **【发现与报修 - 操作员/移动端】**：操作员小张发现贴片机报警，立即使用手机APP扫描设备机身上的二维码。在APP界面选择“吸嘴故障”，并拍摄报警界面照片上传后提交报修。
    2.  **【告警与分派 - 维修主管/PC端】**：维修主管老王的PC端“维修工作台”上立刻弹出一个新的高优先级报修请求。系统根据规则自动推荐电气工程师小李。老王确认后，点击“生成工单并派发”。
    3.  **【接单与执行 - 工程师/移动端】**：小李的手机收到新工单推送。他接受任务，到达现场后点击“开始维修”。排查后发现传感器损坏，通过APP查询并到备件室扫码领用新备件。更换完成后，点击“完成维修”。
    4.  **【填写维修报告 - 工程师/移动端】**：系统提示小李填写报告，他选择故障原因为“元器件老化 -> 传感器损坏”，填写处理措施，并确认系统自动计算的工时和已领用的备件。
    5.  **【验收与关闭 - 生产班长/移动端】**：生产班长老赵收到“维修待验收”的通知。他到现场确认设备稳定运行后，在APP上点击“验收通过”，并给出五星好评。
    6.  **【流程闭环与知识沉淀】**：工单状态自动变为“已关闭”。本次维修的“故障现象-原因-措施”作为一个成功案例，自动存入系统的故障知识库中。

**【请在此处插入故障维修全流程的角色泳道图】**

##### **功能架构**

*   **前端：**
    *   **维修工作台界面模块：**
        *   **报修看板组件：** 以泳道图形式展示所有报修单的状态。
        *   **工单列表组件：** 功能丰富的表格，支持对工单的复杂查询和管理。
        *   **工单详情组件：** 时间轴形式展示工单从创建到关闭的全过程日志和信息。
*   **后端微服务：**
    *   **维保管理服务：**
        *   **接口层：** 提供工单生命周期管理的全部API。
        *   **业务逻辑层：** 包含工单状态机、SLA计算引擎、派单规则引擎、业务编排等核心逻辑。
    *   **备件管理服务：** 提供查询库存、备件消耗等接口。
    *   **资产管理服务：** 提供写入设备履历的接口。
    *   **通知服务：** 集成飞书、短信、邮件等多种通知渠道。
*   **数据层：**
    *   **维修工单主表：** 存储工单核心信息。
    *   **工单操作日志表：** 记录工单生命周期中的每一个动作。
    *   **工单耗用备件表：** 记录维修所用的备件。
    *   **故障知识库表：** 沉淀维修经验。

---

### **4.3 计划性维护**

计划性维护是实现从“被动维修”到“主动预防”转变的关键，旨在通过定期的保养活动，将设备故障消灭在萌芽状态。

##### **详细功能阐述**

1.  **多维度的保养策略定义：** 系统支持灵活创建多样化的保养策略，以适应不同设备的维护需求。
    *   **基于时间的维护 (TBM):** 最常见的策略，如为冲压机设置“每周”进行润滑，“每月”检查模具，“每季度”更换液压油。
    *   **基于用量的维护 (UBM):** 需与MES或IoT平台集成。例如，为CNC机床设置“每运行500小时”更换一次刀具，或为AGV小车设置“每行驶1000公里”检查一次轮胎。
    *   **一次性/周期性任务：** 支持创建一次性的维护任务（如季节性检查），或按不规则周期（如每10天）执行的任务。

2.  **标准化的保养基准库 (SOP)：** 为了确保保养工作的质量和一致性，系统提供强大的保养基准库管理功能。
    *   **结构化内容：** 每份保养基准（SOP）都包含详细的、结构化的信息：保养部位、保养项目、操作方法与标准、所需工具、所需备件、预计工时、安全注意事项等。
    *   **关联与复用：** 一份SOP可以关联到同一型号或类别下的多台设备，实现“一次定义，多处复用”，极大提升了维护计划制定的效率。

3.  **保养计划的自动生成与调度：**
    *   **保养日历：** 系统提供可视化的保养日历，让管理者可以直观地查看未来一段时间内（日/周/月）所有设备的保养任务安排。
    *   **自动触发引擎：** 系统后台的调度引擎会根据所有保养策略，提前（可配置，如提前3天）自动生成保养工单，并进入待派发列表。
    *   **任务合并与优化：** 对于同一台设备在相近时间有多个保养任务的情况，系统支持将它们合并到一个工单中，避免重复停机和人员往返。

4.  **移动化执行与闭环反馈：**
    *   **移动端检查表：** 保养工程师在手机APP上接收保养工单，工单内容即是一份电子化的检查表（Checklist）。工程师需按照SOP要求，逐项完成并勾选确认。
    *   **数据记录与异常上报：** 对于需要记录测量值的项目（如压力、温度），工程师可直接在APP中输入数值。如发现异常，可直接在保养任务中拍照上报，并关联生成一个故障报修单。

##### **业务流程**

*   **场景：** 设备工程师需要为公司所有“三相组串光伏逆变器”老化测试台创建一个月度保养计划。
*   **参与角色：** 设备工程师、维修主管、保养工程师。
*   **流程步骤：**
    1.  **【创建保养基准 - 设备工程师/PC端】**：设备工程师在“保养基准库”中，新建一份名为“逆变器老化测试台月度保养SOP”的文档。他详细录入了10个保养项目，如“清洁散热风扇”、“检查直流输入端子力矩”、“记录绝缘电阻值”等，并为每个项目注明了标准和所需工具。
    2.  **【创建保养策略 - 设备工程师/PC端】**：工程师进入“保养策略”模块，新建一个策略。
        *   **策略名称：** 逆变器测试台月度保养。
        *   **关联设备：** 通过筛选“设备类别=逆变器测试台”，批量选择所有符合条件的设备。
        *   **触发方式：** 选择“基于时间”，设置为“每月”的“1号”执行。
        *   **关联SOP：** 关联上一步创建的“逆变器老化测试台月度保养SOP”。
    3.  **【工单自动生成 - 系统后台】**：时间来到下个月的1号前3天，系统调度引擎自动触发。为每一台逆变器测试台生成了一张保养工单，工单内容完全拷贝自SOP，并自动进入“待派发”状态。
    4.  **【派发与执行 - 维修主管 & 保养工程师/移动端】**：维修主管在工作台上看到这批待派发的保养工单，他将任务批量指派给负责该区域的保养工程师小王。小王在手机APP上接收到任务。
    5.  **【移动端逐项确认】**：小王到现场，打开其中一张工单，APP界面以检查表的形式展示了10个保养项目。他每完成一项，就在后面打勾。当记录“绝缘电阻值”时，他输入了测量结果“5.2 MΩ”。
    6.  **【完成与归档】**：所有项目完成后，小王点击“提交完工”。该保养工单自动关闭，执行记录、测量数据等全部归档到对应设备的履历中。

**【请在此处插入计划性维护业务流程图】**

##### **功能架构**

*   **前端：**
    *   **保养计划管理界面：** 提供保养基准库、保养策略的增删改查功能。
    *   **保养日历组件：** 以日历视图展示保养任务。
    *   **移动端保养工单界面：** 以检查表（Checklist）形式呈现，支持数据录入和拍照。
*   **后端微服务：**
    *   **维保管理服务：**
        *   **接口层：** 提供保养计划、SOP、保养工单相关的API。
        *   **业务逻辑层：**
            *   **调度引擎：** 核心组件，负责定时扫描保养策略并生成工单。
            *   **保养计划服务：** 管理保养策略和SOP。
            *   **保养工单服务：** 管理保养工单的生命周期。
*   **数据层：**
    *   **保养基准表：** 存储SOP主信息。
    *   **保养基准项目表：** 存储SOP的详细检查项目。
    *   **保养策略表：** 定义保养的触发规则和关联关系。
    *   **保养工单表：** 存储由计划生成的工单。
    *   **保养记录表：** 存储保养工单的详细执行结果和测量数据。

---

### **4.4 点巡检管理**

点巡检是设备管理的“第一道防线”，通过高频次的、标准化的检查，及时发现设备运行的微小异常和潜在隐患，是实现预防为主、保障设备稳定运行的重要手段。

##### **详细功能阐述**

1.  **灵活的路线与计划制定：**
    *   **巡检路线定义：** 管理员可在电子地图或车间布局图上，通过拖拽方式定义巡检路线，将需要巡检的设备（点）串联起来，并优化路线顺序，减少巡检人员的无效行走。
    *   **巡检计划配置：** 可按班次、天、周等不同频率设置巡检计划，并将计划指派给特定的岗位或人员。
    *   **标准化的检查项目：** 为每个巡检点定义标准的检查项目（Item），明确检查内容、方法和判断标准（定性：如“正常/异常”、“有/无”；定量：如温度、压力、振动值的记录范围）。

2.  **移动化、智能化的任务执行：**
    *   **任务自动推送：** 巡检任务按计划自动推送到执行人员的手机APP中。
    *   **扫码确认到位：** 巡检员到达设备现场后，必须扫描设备二维码进行“签到”，系统自动记录到位时间，杜绝漏检、假检。
    *   **引导式检查：** APP以检查表形式引导巡检员逐项检查，支持通过拍照、录音、录像等方式记录现场情况。
    *   **离线执行：** 支持在网络信号不佳的区域先离线完成巡检任务，待网络恢复后数据自动同步上传。

3.  **异常发现与快速闭环：**
    *   **一键上报异常：** 巡检过程中，一旦发现异常，巡检员可当即在检查项中标注“异常”，并填写异常描述、拍照上传。
    *   **异常转报修：** 对于需要立即处理的严重异常，巡检员可在APP上一键将该异常升级为“故障报修单”，该报修单将直接进入维修流程，大大缩短了从发现问题到开始处理的时间。

4.  **数据分析与趋势洞察：**
    *   **巡检报告自动生成：** 巡检任务完成后，系统自动生成完整的巡检报告，记录所有检查项的结果和发现的异常。
    *   **异常统计与分析：** 系统可对巡检发现的异常进行统计分析，如“设备异常率TOP10”、“最常见异常类型”等，帮助管理者定位管理薄弱环节。
    *   **参数趋势分析：** 对于巡检中记录的定量数据（如温度、压力），系统可生成趋势图，帮助工程师通过参数的缓慢变化趋势，预判潜在的设备问题。

##### **业务流程**

*   **场景：** 操作工小王需要执行白班的“一号冲压车间”日常巡检任务。
*   **参与角色：** 设备主管、操作工/巡检员、维修主管。
*   **流程步骤：**
    1.  **【计划制定 - 设备主管/PC端】**：设备主管预先已在系统中设定好“一号冲压车间巡检路线”，并创建了一个“每日白班”执行的巡检计划。
    2.  **【任务接收 - 巡检员/移动端】**：小王上班后，打开手机APP，在“我的任务”中看到了“一号冲压车间巡检任务”。
    3.  **【开始巡检与签到】**：小王点击“开始任务”，APP显示出路线上的第一台设备“CP-101号冲床”。他走到设备旁，扫描二维码，系统确认到位，并展示出该设备的检查项。
    4.  **【执行检查与记录】**：小王按照APP上的检查列表逐项检查：
        *   “油位是否正常？” -> 选择“正常”。
        *   “有无异常响声？” -> 选择“正常”。
        *   “电机外壳温度？” -> 用测温枪测量后，输入“55.3”℃。系统判断在正常范围内。
    5.  **【发现并上报异常】**：当巡检到“CP-105号冲床”时，他发现“安全光幕”前的地面有油渍。他在“有无漏油？”一项选择“异常”，并拍摄了一张照片上传，备注“液压管接头疑似渗油”。
    6.  **【异常升级】**：他判断这个渗油问题需要维修人员处理，于是点击“转报修”按钮。系统自动带出设备信息和异常描述，生成了一张新的维修单。
    7.  **【完成任务】**：小王继续完成路线上所有设备的巡检，最后点击“提交任务”。
    8.  **【流程闭环】**：维修主管的PC端收到了由巡检异常转来的新报修请求，并立即派工处理。设备主管则可以在后台查看到小王完整的巡检报告和发现的异常统计。

**【请在此处插入点巡检管理业务流程图】**

##### **功能架构**

*   **前端：**
    *   **巡检路线规划界面：** 支持在地图或平面图上进行可视化路线编辑。
    *   **巡检计划管理界面：** 配置巡检任务的频率、内容和执行人。
    *   **移动端巡检任务界面：** 任务列表、扫码签到、检查表执行、异常上报的核心操作界面。
*   **后端微服务：**
    *   **维保管理服务：**
        *   **接口层：** 提供巡检路线、计划、记录、异常等相关的API。
        *   **业务逻辑层：** 包含巡检任务的生成、推送、执行状态管理，以及异常转报修的逻辑。
*   **数据层：**
    *   **巡检路线表：** 存储路线信息及路线上的设备点顺序。
    *   **巡检计划表：** 定义巡检任务的规则。
    *   **巡检任务记录表：** 存储每一次巡检任务的执行详情。
    *   **巡检异常表：** 专门记录巡检中发现的所有异常情况。

---
### **4.5 备品备件管理**
备品备件管理是设备维护工作的“后勤保障”，旨在以合理的库存成本，确保维修、保养所需备件的及时供应，是降低设备停机时间、控制维护成本的关键环节。

##### **详细功能阐述**

1.  **全面的备件电子台账：**
    *   **一物一码：** 为每一种备件建立唯一的物料编码，并可生成条码/二维码进行标识管理。
    *   **详细信息记录：** 记录备件的名称、规格型号、材质、供应商、价格、存放位置（精确到货架位）、关联设备（设备备件BOM）等信息，并支持上传备件图片、图纸等附件。

2.  **全流程的出入库与盘点管理：**
    *   **多种业务类型：** 支持采购入库、领用出库、退料入库、盘点、调拨、报废等所有仓储业务类型。
    *   **移动化扫码作业：** 仓库管理员通过移动端APP扫描条码/二维码，可快速完成备件的出入库和盘点操作，数据实时同步到系统，极大提升了作业效率和准确性。
    *   **与工单联动：** 维修工程师领料时，扫描维修工单的二维码，再扫描所需备件的条码，系统即可自动完成出库操作，并将备件消耗记录和成本自动关联到该维修工单，形成完整的成本追溯链条。

3.  **智能化的库存预警与补货策略：**
    *   **安全库存管理：** 可为每种备件设置安全库存、最小库存和最大库存阈值。
    *   **自动预警：** 当备件库存量低于安全库存时，系统会自动触发预警，并通过消息通知采购或仓储管理人员。
    *   **智能补货建议：** 系统可根据历史消耗数据和当前的库存水平，自动生成采购申请或补货建议清单，供相关人员审批。
    *   **ABC分类分析：** 系统支持对备件进行ABC分类管理，对价值高、重要性强的A类备件进行重点监控和管理。
    *   **呆滞料分析：** 自动识别长期未发生出入库的呆滞物料，并生成报告，为库存优化和资产盘活提供决策依据。

##### **业务流程**

*   **场景：** 维修工程师小李在维修贴片机时需要领用一个传感器，同时仓库管理员需要对该批次备件进行采购入库。
*   **参与角色：** 采购员、仓库管理员、维修工程师。
*   **流程步骤 (入库)：**
    1.  **【采购到货】**：一批新的传感器到货。
    2.  **【扫码入库 - 仓库管理员/移动端】**：仓库管理员老张用APP扫描采购订单号，系统显示出待入库的备件列表。他逐一扫描每个备件包装上的条码，并输入本次到货数量。
    3.  **【上架确认】**：系统推荐了存放货位，老张将备件放到指定货位后，在APP上确认上架。系统库存实时增加。
*   **流程步骤 (出库)：**
    1.  **【现场需求 - 维修工程师/移动端】**：维修工程师小李在维修工单中，发现需要更换传感器。他通过APP查询，确认仓库有库存。
    2.  **【扫码领料】**：小李到达备件室，向老张出示他手机上的维修工单二维码。
    3.  **【扫码出库 - 仓库管理员/移动端】**：老张用APP扫描小李的工单二维码，再扫描从货架上取下的传感器条码。
    4.  **【自动关联与扣减】**：系统自动完成出库操作，库存数量减1。同时，这颗传感器的成本自动计入小李正在执行的维修工单中。
*   **流程步骤 (库存预警)：**
    1.  **【触发预警 - 系统后台】**：本次出库后，系统检测到该型号传感器的库存量已低于设定的安全库存。
    2.  **【生成采购申请】**：系统自动生成一张采购申请单，并进入采购审批流程。

**【请在此处插入备品备件出入库及预警流程图】**

##### **功能架构**

*   **前端：**
    *   **备件管理界面：** 备件台账查询、库存看板、出入库记录查询、盘点任务管理等。
    *   **移动端仓库作业界面：** 简洁的扫码出入库、盘点操作界面。
*   **后端微服务：**
    *   **备件管理服务：**
        *   **接口层：** 提供备件台账、库存、出入库、盘点等全套管理API。
        *   **业务逻辑层：** 包含库存预警引擎、ABC分析算法、呆滞料分析逻辑等。
*   **数据层：**
    *   **备件主数据表：** 存储备件的基础信息。
    *   **库存表：** 实时记录每种备件在不同仓库的库存数量。
    *   **出入库记录表：** 记录每一次库存变动流水。
    *   **设备备件关系表 (BOM)：** 记录设备与所需备件的对应关系。

---
### **4.6 预测性维护**

预测性维护(PdM)是设备管理从“被动”走向“预测”的智能化升级，旨在通过对设备运行数据的实时监测和智能分析，“预知”未来可能发生的故障，从而在故障发生前采取干预措施，实现最大化的设备可用性和最小化的维修成本。

##### **详细功能阐述**

1.  **多源数据采集与融合：**
    *   **实时工况数据：** 通过物联网平台，接入设备关键测点的传感器数据（如振动、温度、压力、电流）和控制系统数据（PLC/DCS的运行参数）。
    *   **历史运维数据：** 整合本系统内的历史维修记录、保养记录、备件更换记录等，这些数据是标注故障模式的重要来源。
    *   **关联业务数据：** 集成来自MES的生产数据（如加工批次、产品型号），分析特定工况对设备健康的影响。
    *   **数据治理与标签体系：** 建立统一的数据标签(Tag)体系，对采集到的多源异构数据进行清洗、对齐和标准化，为后续的分析建模奠定高质量的数据基础。

2.  **智能分析与预测模型：**
    *   **健康状态评估：** 基于多维度的运行参数和历史数据，通过专家规则或机器学习算法（如PCA主成分分析），构建设备健康指数(HI)模型，将设备复杂的运行状态量化为一个直观的健康分值。
    *   **故障早期预警：** 利用统计过程控制(SPC)或异常检测算法（如孤立森林、LSTM自编码器），在设备性能出现早期微小偏离时自动触发预警，远早于传统阈值报警。
    *   **故障模式识别：** 结合特征工程（如振动信号的频域分析）和分类模型（如支持向量机、决策树），当检测到异常时，系统能自动识别出最有可能的故障模式（如轴承外圈磨损、转子不平衡、齿轮断齿等）。
    *   **剩余使用寿命(RUL)预测：** 对关键的、有磨损规律的部件，利用回归模型或深度学习模型，预测其从当前状态到功能失效的剩余时间或使用次数，为维修计划提供精确的时间窗口。

3.  **预测结果的可视化与决策支持：**
    *   **设备健康驾驶舱：** 在PC端和大屏上，以仪表盘、趋势图、设备拓扑热力图等形式，直观展示产线或车间的整体设备健康状况和预警分布。
    *   **诊断分析视图：** 为设备工程师提供专业的分析工具，如下钻查看某一预警的详细数据波形、频谱图，以及模型的诊断依据，辅助工程师进行最终确认。

4.  **从预测到行动的闭环联动：**
    *   **智能工单触发：** 当系统发布高置信度的故障预警或RUL预警时，可配置自动创建“预见性维修工单”，工单中包含预测的故障部位、原因和建议的维修措施，并自动派发给相关工程师。
    *   **与备件系统联动：** 当预测到某个部件即将失效时，系统可自动检查对应备件的库存，若库存不足则自动触发补货流程，确保在需要时备件已到位。

##### **业务流程**

*   **场景：** 一台核心生产线上的高精度主轴电机，其振动和温度传感器已接入本系统。
*   **参与角色：** 系统AI模型、设备工程师、维修主管。
*   **流程步骤：**
    1.  **【持续监测 - 系统后台】**：系统持续接收并分析主轴电机的振动和温度数据。
    2.  **【早期异常检测】**：AI模型发现，该电机的振动信号在某个特定频段的能量持续、缓慢地上升，虽然总振动值仍在安全阈值内，但已偏离了其正常的“健康基线”。
    3.  **【触发预警与诊断】**：系统生成一个“注意”级别的预警。诊断模型进一步分析该特征频率，匹配到知识库中的“轴承内圈点蚀”故障模式。同时，RUL模型预测，在当前工况下，该轴承的剩余使用寿命约为20天。
    4.  **【通知与分析 - 设备工程师/PC端】**：设备工程师收到预警通知，在PC端打开“预测性维护”模块，查看到该电机的健康指数开始下降，并有明确的诊断结果和RUL预测。他可以下钻查看详细的振动频谱图，确认了诊断的可靠性。
    5.  **【生成预见性维修工单】**：工程师基于预警信息，手动创建了一张“预见性维修工单”，任务类型为“更换主轴轴承”，计划停机维修时间定在15天后的周末。
    6.  **【联动备件】**：系统在创建工单时，自动检查了所需型号轴承的库存，显示库存充足。
    7.  **【执行与验证】**：15天后，维修团队按计划更换了轴承。旧轴承经检查，确实已出现早期点蚀，验证了预测的准确性。本次维修避免了一次非计划停机，节约了大量潜在损失。

**【请在此处插入预测性维护业务流程图】**

##### **功能架构**

*   **前端：**
    *   **预测性维护驾驶舱：** 可视化展示全局设备健康状态、预警信息。
    *   **诊断分析工作台：** 提供数据下钻、波形/频谱分析等专业工具。
*   **后端微服务：**
    *   **预测性维护服务：**
        *   **接口层：** 提供预警查询、健康指数查询等API。
        *   **业务逻辑层：** 包含数据接入与预处理、模型调用、预警规则引擎等。
    *   **物联网/数据接入服务：** 负责与底层设备和传感器的数据通信。
    *   **(可选) 机器学习平台：** 一个独立的服务或平台，负责AI模型的训练、部署和管理。预测性维护服务会调用该平台上的模型API。
*   **数据层：**
    *   **时序数据库 (InfluxDB)：** 存储海量的原始传感器数据。
    *   **关系型数据库：** 存储预警记录、健康指数结果、模型元数据等。
    *   **数据湖/文件存储：** 存储用于模型训练的历史数据集。

---
### **4.7 知识库管理**
知识库是将个人经验转化为组织财富的核心模块。它通过系统化的方式，沉淀、管理和分享设备维护过程中的知识和经验，旨在提升团队整体的故障诊断能力，缩短新人培养周期，并为智能化应用提供数据基础。

##### **详细功能阐述**

1.  **多维度的知识条目：**
    *   **维修案例库：** 核心部分。每一次成功的维修工单（特别是包含详细原因分析和处理措施的），在关闭后都可以由工程师或主管一键转存为知识库案例。案例内容结构化，包含：设备型号、故障现象、原因分析、处理步骤、所用备件/工具、经验总结等。
    *   **标准作业程序(SOP)库：** 集中管理设备的操作规程、保养规程、安全规程等标准文档，支持图文、视频等多种格式，并进行版本控制。
    *   **故障树分析(FTA)：** 对复杂设备，可构建可视化的故障树。当出现某个顶层故障现象时，工程师可以沿着故障树逐层排查可能的原因，提高诊断效率。
    *   **专家知识库：** 记录资深专家的“独门秘籍”或特定问题的处理技巧。

2.  **智能化的知识获取与推荐：**
    *   **便捷的知识录入：** 在维修工单、保养工单关闭时，系统会智能提取关键信息，并提示用户是否将其沉淀为知识库条目，简化录入过程。
    *   **智能检索：** 提供强大的全文搜索引擎，支持按设备型号、故障关键词、备件名称等多种方式进行快速检索。
    *   **场景化知识推荐：** 当维修工程师处理新的维修工单时，系统可根据当前工单的设备型号和故障现象描述，自动从知识库中检索并推荐最相似的历史维修案例，为工程师提供参考。

3.  **知识的审核、评价与持续优化：**
    *   **审核机制：** 新创建的知识条目可设置审核流程，由资深工程师或主管审核通过后才能正式发布，保证知识的准确性。
    *   **评价与反馈：** 用户在使用知识库后，可以对知识条目的有效性进行评分和评论。高评分的知识条目会被优先推荐。
    *   **版本迭代：** 知识条目支持版本修订，保留历史版本，确保知识的持续更新和完善。


##### **业务流程**

*   **场景：** 新人维修工程师小王接到一个“伺服电机定位不准”的维修工单，他对此问题经验不足。
*   **参与角色：** 新人工程师小王、资深工程师老李（作为知识贡献者）。
*   **流程步骤：**
    1.  **【接收工单与知识求助】**：小王在手机APP上接到工单，对问题没有头绪。
    2.  **【智能推荐】**：他打开工单详情，系统已根据“伺服电机”、“定位不准”等关键词，在下方自动推荐了3条相关的知识库案例。
    3.  **【检索与学习】**：其中一条由老李提交的案例《关于XX品牌伺服电机编码器干扰导致定位不准问题的排查》，标题非常匹配。小王点开查看，案例中详细描述了排查步骤：首先检查参数设置，然后检查机械连接，最后重点排查编码器信号线是否受变频器干扰。案例还附带了一张正确的屏蔽线接地照片。
    4.  **【解决问题】**：小王按照案例中的指导，最终发现是编码器的屏蔽线接地不规范导致的问题。他参照照片重新处理后，故障解决。
    5.  **【知识反馈与贡献】**：在关闭工单时，小王对老李的这条知识给予了五星好评，并补充评论：“此方法有效！补充一点，最好使用双绞屏蔽线缆。”
    6.  **【知识沉淀】**：小王本次的维修记录，因为有新的补充信息，也被主管审核后，作为该知识条目的一个补充案例存入知识库，使知识体系更加丰满。

**【请在此处插入知识库应用流程图】**

##### **功能架构**

*   **前端：**
    *   **知识库门户界面：** 提供知识分类浏览、高级搜索、热门知识排行等功能。
    *   **知识条目详情页：** 图文并茂地展示知识内容，并有关联案例、评价等。
*   **后端微服务：**
    *   **知识库管理服务：**
        *   **接口层：** 提供知识的增删改查、审核、评价等API。
        *   **业务逻辑层：**
            *   **搜索引擎集成：** 与Elasticsearch等专业搜索引擎集成，实现强大的全文检索和智能推荐功能。
            *   **知识图谱（可选）：** 对于更高级的应用，可构建设备-故障-原因-备件的知识图谱，提供更智能的诊断推荐。
*   **数据层：**
    *   **关系型数据库：** 存储结构化的知识条目，如SOP、审核记录、评价等。
    *   **搜索引擎 (Elasticsearch)：** 为知识内容建立索引，用于快速检索。

---
### **4.8 综合效率(OEE)与统计分析**
本模块是数据驱动决策的核心，旨在将设备管理过程中产生的海量数据转化为有价值的洞察。通过对设备综合效率(OEE)的精准计算和多维度分析，帮助管理者发现生产瓶颈、定位损失原因，并持续改进。

##### **详细功能阐述**

1.  **自动化的OEE计算：**
    *   **数据自动采集：** 系统与MES或IoT平台深度集成，自动获取计算OEE所需的核心数据：
        *   **计划运行时间：** 来自生产计划。
        *   **实际运行时间：** 综合计划停机（如换型、保养）和非计划停机（故障、缺料）时间计算得出。
        *   **标准节拍与实际产量：** 来自MES或设备本身。
        *   **合格品数：** 来自质量系统或MES。
    *   **OEE核心指标计算：** 系统自动实时计算并展示OEE的三大核心因子及最终结果：
        *   **时间稼动率 = 实际运行时间 / 计划运行时间**
        *   **性能稼动率 = (标准节拍 × 实际产量) / 实际运行时间**
        *   **质量合格率 = 合格品数 / 实际产量**
        *   **OEE = 时间稼动率 × 性能稼动率 × 质量合格率**

2.  **多维度的OEE可视化与下钻分析：**
    *   **OEE驾驶舱：** 提供从公司、车间、产线到单个设备的多层级OEE看板，管理者可以快速概览整体绩效，并层层下钻，定位OEE表现不佳的具体单元。
    *   **趋势分析：** 展示OEE及其三大因子的历史趋势（按日/周/月），帮助识别绩效的变化规律。
    *   **对比分析：** 支持对不同产线、班组、设备型号的OEE进行横向对比，发现标杆和改进机会。

3.  **六大损失(Six Big Losses)的深入分析：**
    *   系统将所有停机和性能损失时间，自动归类到经典的六大损失中：
        *   **故障损失：** 来自维修工单记录的故障停机时间。
        *   **换型调试损失：** 来自MES记录的计划停机。
        *   **短暂停止与空转损失：** 通过分析设备运行状态和节拍差异识别。
        *   **速度降低损失：** 通过对比实际节拍与标准节拍识别。
        *   **开工/过程废品损失：** 来自质量数据。
        *   **停工/调试废品损失：** 来自质量数据。
    *   **柏拉图(Pareto)分析：** 通过柏拉图，直观展示占比最高的损失项，帮助团队聚焦主要矛盾，进行针对性改善（如“导致停机时间最长的前五大故障原因”）。

4.  **丰富的预置报表与自定义报表工具：**
    *   **预置报表：** 系统内置一系列常用报表，如：设备维修成本分析报表、备件消耗分析报表、MTBF/MTTR分析报表、预防性维护计划执行率报表等。
    *   **自定义报表工具：** 集成低代码平台的报表设计器，用户可以通过拖拽方式，灵活选择数据维度和指标，创建满足个性化管理需求的报表，并支持导出为Excel或PDF。

##### **业务流程**

*   **场景：** 生产经理需要分析上周光伏组件层压产线的OEE表现，并找出关键的改善点。
*   **参与角色：** 生产经理。
*   **流程步骤：**
    1.  **【进入OEE驾驶舱】**：生产经理登录系统，进入“统计分析”模块的“OEE驾驶舱”。驾驶舱显示整个工厂上周的平均OEE为75%。
    2.  **【层层下钻】**：他点击“组件事业部”，看到其OEE为78%。再点击“层压产线”，发现其OEE仅为65%，是主要的瓶颈。
    3.  **【分析OEE构成】**：在层压产线的OEE详情页，他看到：时间稼动率为85%，性能稼动率为90%，但质量合格率仅为85%。这表明质量问题是主要瓶颈。
    4.  **【深入分析损失】**：他切换到“六大损失分析”视图，柏拉图显示，“过程废品损失”占到了总损失的40%。
    5.  **【关联数据与定位根因】**：他点击“过程废品损失”条目，系统下钻显示出导致废品的具体原因统计，其中“组件内部气泡”占比最高。系统进一步关联了这段时间内的维修记录，发现一台层压机的真空系统曾多次报修。
    6.  **【制定改进措施】**：基于数据分析，生产经理召集设备和工艺工程师，决定对该层压机的真空系统进行一次彻底的预防性维护，并加强操作员对层压参数的监控。
    7.  **【持续跟踪】**：在接下来的几周，他将持续通过OEE趋势图监控层压产线的OEE变化，验证改进措施的有效性。

**【请在此处插入OEE分析与持续改进流程图】**

##### **功能架构**

*   **前端：**
    *   **数据可视化库 (如ECharts)：** 用于构建各种驾驶舱图表，如仪表盘、柱状图、折线图、柏拉图。
    *   **报表设计器组件：** 提供拖拽式的自定义报表设计界面。
*   **后端微服务：**
    *   **统计分析服务：**
        *   **接口层：** 提供获取OEE数据、各类报表数据的API。
        *   **业务逻辑层：**
            *   **OEE计算引擎：** 定时或实时地从其他服务（维保、资产）和外部系统（MES）拉取数据，进行OEE计算。
            *   **报表生成服务：** 根据请求动态生成报表数据。
    *   **数据仓库/数据集市（可选）：** 对于大规模、复杂的分析需求，可构建专门的数据仓库，预先对数据进行ETL和汇总，以提升查询性能。
*   **数据层：**
    *   **OEE结果表：** 存储按不同维度（设备、产线、时间）计算好的OEE结果。
    *   **损失记录表：** 存储归类后的六大损失数据。
    *   **数据从业务库（如工单表）和外部系统（MES）中抽取。**

---
### **4.4 技改管理**
技术改造（简称“技改”）是设备管理中提升资产价值、突破生产瓶颈、适应新工艺需求的重要活动。它区别于日常维修，是一个以提升设备性能、效率、安全性或功能为目标的、有计划、有预算、有评估的微型项目。本模块旨在对技改项目提供全生命周期的线上化、流程化、精细化管理。

##### **详细功能阐述**

1.  **全生命周期项目化管理：**
    *   **项目立项申请：** 任何相关人员（如工艺工程师、生产主管）都可在线提交技改申请。申请表单结构化，需清晰阐述**技改背景与痛点**、**目标与预期收益**（如OEE提升预估、成本节约、安全改善等）、**初步技术方案**和**预估费用**。
    *   **多级审批工作流：** 技改项目需经过严格的审批流程。系统支持通过低代码平台配置灵活的多级审批流，可涵盖技术评估、财务预算审批、管理层决策等环节，并与OA系统无缝集成，实现统一审批。
    *   **项目状态跟踪：** 每个技改项目都有明确的状态（如草稿、待审批、已批准、进行中、已完成、已关闭），所有干系人都可以清晰地看到项目进展。

2.  **精细化的方案与预算管理：**
    *   **技术方案库：** 在项目执行阶段，可上传详细的技术方案、设计图纸、BOM清单等，并进行版本控制。
    *   **预算控制：** 项目可设定详细的预算，包括材料费、人工费、外协费等。在项目执行过程中，领用的备件成本、发生的人员工时将自动与项目关联，系统实时核算**实际花费与预算的执行偏差**，并提供预警。

3.  **过程执行与协同：**
    *   **任务分解与派工：** 可将复杂的技改项目分解为多个子任务，并指派给不同的执行人或团队，明确每个任务的起止时间和交付要求。
    *   **执行过程记录：** 执行人员可在移动端或PC端反馈任务进度，上传施工照片、调试记录等过程文件，形成完整的项目执行档案。

4.  **成果验证与知识转化：**
    *   **项目验收与效益评估：** 项目完成后，需进行正式的验收。系统提供验收检查表功能，并要求项目负责人提交**效益评估报告**，通过对比技改前后的关键性能指标（KPI），量化技改项目的实际成果。
    *   **关联资产档案更新：** 技改项目成功验收后，这是至关重要的一步。系统会**强制或提示**项目负责人更新关联设备的资产档案，包括：
        *   更新**技术参数**（如产能、精度、功率等）。
        *   上传最新的**设备图纸和操作SOP**。
        *   修改或新增关联的**保养计划**。
    *   此举确保了设备的“数字孪生档案”与物理实体始终保持一致，避免了“账实不符”的问题。

##### **业务流程**

*   **场景：** 某光伏逆变器老化测试台，因产品迭代，其测试通道数量成为生产瓶颈，工艺工程师小李计划将其从10通道扩容到20通道。
*   **参与角色：** 工艺工程师小李、设备经理老王、财务部、维修团队。
*   **流程步骤：**
    1.  **【项目立项 - 工程师/PC端】**：小李登录系统，在“技改管理”模块新建一个技改项目。他填写项目名称为“老化测试台通道扩容”，阐述了当前产能瓶颈，并预估技改后测试效率可提升100%，预估费用为5万元。
    2.  **【技术与财务审批 - 经理 & 财务/OA或系统】**：项目申请被提交。流程首先流转到设备经理老王处，老王评估技术方案可行，点击“同意”。随后，流程自动流转到财务部进行预算审批，财务部确认预算合理后，审批通过。
    3.  **【项目启动与执行】**：项目状态变为“已批准”。老王作为项目经理，将项目分解为“新模块采购”、“电气改造”、“软件调试”等任务，并分别指派给采购部和维修团队。
    4.  **【过程跟踪与成本归集】**：维修团队在执行电气改造时，通过系统领用了相关备件，这些备件的成本自动计入该技改项目的实际花费中。
    5.  **【项目完工与验收】**：所有任务完成后，项目进入“待验收”状态。小李和老王共同组织了现场验收，通过连续测试，确认测试台已能稳定支持20通道同时工作，并在系统内完成验收签核。
    6.  **【更新资产档案与关闭】**：系统提示老王，由于技改完成，需更新资产档案。老王进入该测试台的设备台账，将其“技术参数”中的“测试通道数”由“10”修改为“20”，并上传了新的电气图纸。完成更新后，技改项目正式关闭，所有资料归档。

**【请在此处插入技改管理业务流程图】**

##### **功能架构**

*   **前端：**
    *   **技改项目管理界面：** 提供项目列表（看板视图/列表视图）、项目详情页（包含基本信息、审批历史、任务分解、预算执行、关联文档等）。
    *   **流程设计器 (低代码平台部分)：** 用于配置技改的审批流程。
*   **后端微服务：**
    *   **技改管理服务 (新增)：** 一个独立的微服务，专门负责技改项目的全生命周期管理。
        *   **接口层：** 提供技改项目、任务、预算等相关的API。
        *   **业务逻辑层：** 包含审批工作流引擎（可集成Camunda等）、项目状态管理、预算与实际成本核算逻辑。
    *   **资产管理服务：** 技改服务会在验收关闭后，调用其接口来更新设备档案。
    *   **备件管理服务：** 技改服务会调用其接口，将领用的备件成本归集到项目中。
*   **数据层：**
    *   **技改项目主表：** 存储项目基本信息、状态、预算等。
    *   **技改项目任务表：** 存储项目分解后的子任务。
    *   **技改成本记录表：** 记录项目花费的每一笔成本。
    *   **技改审批历史表：** 记录审批流程的每一个节点和意见。

---
### **4.5 闲置设备管理**
闲置设备是沉睡的资产，有效的管理可以盘活存量、减少不必要的采购、实现资产价值最大化。本模块旨在建立一个公司级的闲置设备资源池，并对闲置设备的评估、调拨、封存、租售及报废处置提供规范化的流程管理。

##### **详细功能阐述**

1.  **闲置设备资源池：**
    *   **状态标识与入池：** 当设备因产线调整、任务结束等原因不再使用时，负责人可在系统中将其状态变更为“闲置”，设备将自动进入“闲置设备资源池”。
    *   **集中展示与查询：** 提供一个全局的闲置设备看板或列表，展示所有闲置设备的详细信息，如当前状况、存放位置、技术参数、评估价值等。各部门在有新设备需求时，可优先在此查询，促进内部调剂。

2.  **闲置评估与处置建议：**
    *   **评估流程：** 设备进入闲置状态后，可触发一个标准化的评估流程。由设备、财务等相关人员组成的评估小组，对设备的技术状态、维修成本、残值进行综合评估。
    *   **处置建议：** 评估完成后，形成包含“建议内部调拨”、“建议封存”、“建议出售”、“建议报废”等结论的评估报告，为后续决策提供依据。

3.  **规范化的处置流程管理：**
    *   **内部调拨：** 需求部门可在线发起对闲置设备的调拨申请。经审批通过后，系统记录资产的责任部门、成本中心、安装位置的变更，设备状态由“闲置”重新变为“在用”。
    *   **设备封存：** 对于暂时不用但有保留价值的设备，可执行“封存”流程。系统记录其封存位置，并可为其关联特殊的“封存期保养计划”（如定期通电、防锈处理）。
    *   **设备出售/租赁：** 对外出售或租赁的设备，可管理其交易信息，包括客户、价格、合同等，并最终更新资产状态。
    *   **设备报废：** 经过评估确认无使用和维修价值的设备，启动报废流程。经审批后，系统记录资产的最终处置情况，并可生成与SAP集成的接口数据，完成财务销账。

##### **业务流程**

*   **场景：** 一条旧的产品组装线被淘汰，其中一台功能完好的“半自动焊接机”闲置下来。
*   **参与角色：** 原产线主管、设备资产管理员、新项目工程师。
*   **流程步骤：**
    1.  **【闲置入池 - 产线主管】**：原产线主管在系统中找到这台焊接机，将其状态从“在用”修改为“闲置”，并注明闲置原因为“产线升级淘汰”。设备自动进入闲置资源池。
    2.  **【发起评估 - 资产管理员】**：资产管理员收到设备闲置通知，启动了对该焊接机的评估流程，并指派一位资深工程师进行技术鉴定。评估报告结论为“设备状态良好，建议内部调拨或封存”。
    3.  **【内部查询与申请 - 新项目工程师】**：与此同时，负责一个新研发项目的小张正需要一台焊接机。他在提交采购申请前，按规定先到“闲置设备资源池”中查询。他发现了这台设备，技术参数完全满足需求。于是，他立即提交了“内部调拨申请”。
    4.  **【调拨审批与执行】**：调拨申请经过小张的部门经理和资产管理员审批通过。系统生成一张调拨任务单，通知仓库和维修团队将设备从旧产线搬运至研发实验室并完成安装。
    5.  **【更新资产信息 - 资产管理员】**：设备在新地点安装调试完毕后，资产管理员在系统中完成调拨流程，将该焊接机的“所属部门”更新为“研发部”，“安装位置”更新为“研发实验室”，设备状态也由“闲置”重新变回“在用”。
    6.  **【流程闭环】**：一次成功的内部利旧，为公司节省了一台新设备的采购成本。

**【请在此处插入闲置设备管理业务流程图】**

##### **功能架构**

*   **前端：**
    *   **闲置设备池界面：** 以卡片或列表形式，图文并茂地展示闲置设备，提供强大的搜索和筛选功能。
    *   **处置流程表单：** 针对调拨、封存、出售、报废等不同场景，提供不同的线上申请和审批表单。
*   **后端微服务：**
    *   **资产管理服务：** 闲置管理的核心逻辑应内置于此服务中，因为它本质上是设备生命周期状态的一个重要分支。
        *   **接口层：** 新增用于管理评估、调拨、报废等流程的API。
        *   **业务逻辑层：**
            *   **扩展设备状态机：** 在原有的设备状态模型中，增加“闲置”、“封存中”、“待报废”等状态，并管理其流转规则。
            *   **处置工作流：** 为不同的处置类型定义相应的业务处理逻辑。
*   **数据层：**
    *   **设备主表：** 扩展`status`字段的枚举值，增加`location_desc`（如存放仓库）等字段。
    *   **设备评估记录表：** 存储对闲置设备的评估报告。
    *   **设备处置记录表：** 记录最终的处置方式、对象和价值。



---
### **4.9 移动应用**
移动应用是连接管理层与生产现场的桥梁，是将系统能力赋能给一线员工、实现数据实时采集和业务现场处理的关键工具。我们的移动端设计遵循“角色化、场景化、极简化”的原则。

##### **详细功能阐述**

1.  **基于角色的个性化工作台：**
    *   不同角色的用户登录APP后，将看到完全不同的首页和功能菜单，直达其核心工作场景。
    *   **操作员工作台：** 突出“扫码报修”、“查看设备SOP”、“我的巡检任务”。
    *   **维修员工作台：** 突出“我的待办工单”、“扫码领料”、“知识库查询”。
    *   **管理人员工作台：** 突出“OEE看板”、“工单审批”、“报表速览”。

2.  **全场景的现场作业支持：**
    *   **报修单管理：** 随时随地发起报修，上传图片/视频，跟踪维修进度，进行维修验收。
    *   **工单管理：** 接收工单推送，查看工单详情，执行、反馈、暂停、转派工单，填写维修报告。
    *   **点巡检执行：** 接收巡检任务，扫码确认到位，按照电子检查表执行，上报异常并一键转报修。
    *   **备件管理：** 查询备件库存，扫码领用/退还备件，参与移动盘点。
    *   **信息查询：** 扫描设备二维码，即可快速查询该设备的详细台账、历史维修保养记录、关联技术文档等。

---
### **4.8 设备智能体 (Equipment Intelligent Agent)**
设备智能体是构建在新一代人工智能技术之上的、专为设备管理领域打造的智能助手。它不仅仅是一个搜索工具，更是一个具备**理解、推理、生成和交互**能力的“虚拟专家”。它将深度融入系统的各个环节，特别是移动端，为现场工程师提供全天候、专家级的智能支持，旨在将知识的应用从“人找知识”变革为“知识找人，甚至知识辅助人决策”。

##### **详细功能阐述**

1.  **基于大语言模型的自然语言交互：**
    *   **上下文理解：** 智能体（Agent）的核心是强大的大语言模型（LLM），经过设备管理领域专业知识的微调（Fine-tuning）。它能准确理解工程师输入的自然语言，包括行业术语、缩写甚至是口语化的故障描述（例如，输入“3号线那台压机没力气了”能被理解为“3号产线CP-003压力机压力不足”）。
    *   **多轮对话能力：** Agent具备记忆和上下文理解能力，可以与工程师进行连续的多轮对话，逐步澄清问题，而不是一次性的“一问一答”。

2.  **智能引导式故障诊断：**
    *   **动态诊断树：** Agent基于后台构建的故障树（FTA）知识库和海量的历史维修案例，能够像一位经验丰富的专家一样，引导工程师进行排查。它不是简单地罗列可能性，而是通过提问的方式，一步步缩小故障范围。
    *   **示例对话：**
        *   **工程师：** “注塑机温度控制异常。”
        *   **Agent：** “收到。请问是无法升温、温度超调还是温度不稳定？”
        *   **工程师：** “温度超调，设定180度，最高冲到200度。”
        *   **Agent：** “了解。根据历史案例，75%的温度超调问题与PID参数设置有关。您是否检查过该设备的PID参数？我可以为您调出该型号设备的出厂推荐参数。”

3.  **精准、多维度的方案智能推荐：**
    *   **融合推荐引擎：** 当故障现象明确后，Agent会启动一个融合推荐引擎，同时从多个知识源中检索信息，并进行综合排序后呈现给工程师：
        *   **最高相似度案例：** 推荐与当前设备型号、故障现象最匹配的历史成功维修案例。
        *   **相关SOP/图纸：** 自动推送相关的操作规程、维修手册或电气图纸。
        *   **高频更换备件：** 根据历史数据，列出处理此类故障最常更换的备件清单，并实时显示当前库存。
        *   **专家提示：** 调出资深专家在处理类似问题时留下的经验总结或注意事项。

4.  **即时、准确的跨系统知识问答：**
    *   **统一知识入口：** Agent打通了设备管理系统内部以及关联系统的数据库。工程师无需在多个模块间切换，只需通过对话即可获取信息。
    *   **问答示例：**
        *   “这台设备的上次保养是什么时候做的？” (查询本系统履历)
        *   “备件BN-12345的库存还有多少？放在哪个货架？” (查询备件模块)
        *   “今天下午A产线排产了什么产品？” (通过接口查询MES)
        *   “给我看看这张维修工单的审批进度。” (查询本系统工单流程)

5.  **经验的自动化学习与知识库反哺：**
    *   **闭环学习机制：** 每一次与工程师的交互，特别是最终被采纳并成功解决问题的方案，都会被系统标记为一次成功的“学习样本”。
    *   **新知识生成与沉淀：** Agent能够自动将一次有价值的诊断对话过程（问题->诊断路径->解决方案->结果）进行结构化整理，生成一份新的维修案例草稿。经由主管或专家审核确认后，即可一键存入知识库，实现知识的自动化、持续性增长。
    *   **知识图谱优化：** 对于高频出现但知识库覆盖不足的问题，系统会自动生成“知识盲点”报告，提示知识管理员进行补充和完善。

6.  **多模态交互与感知：**
    *   **语音交互：** 在不方便打字的现场环境中，工程师可以直接通过语音与Agent对话，解放双手。
    *   **图像识别辅助诊断：** 工程师可以拍摄故障部件、设备报警界面、甚至是异常声音的声谱图上传给Agent。后台的多模态模型可以对图像进行初步识别（如“液压油泄漏”、“接触器烧毁”、“轴承异响特征频率”等），为Agent的诊断提供更丰富的输入信息。

##### **业务流程**

*   **场景：** 一位入职半年的维修工程师小周，独立处理一台“全自动绕线机”的“频繁断线”故障。
*   **参与角色：** 维修工程师小周、设备智能体(Agent)。
*   **流程步骤：**
    1.  **【发起对话 - 工程师/移动端】**：小周在工单界面，点击右下角的“智能体”图标，激活对话窗口。他输入（或语音说出）：“这台绕线机老是断线，怎么回事？”
    2.  **【澄清问题 - Agent】**：Agent回复：“好的，正在处理‘绕线机频繁断线’问题。为了更准确定位，请问断线主要发生在启动、高速运行还是停止阶段？”
    3.  **【提供信息 - 工程师】**：小周回复：“主要是在高速运行时。”
    4.  **【智能诊断与推荐 - Agent】**：Agent立即推送了以下信息卡片：
        *   **【Top 1 案例】** “关于XX绕线机高速中断线问题的解决方案（相似度92%）”，摘要显示与张力控制器设置有关。
        *   **【SOP文档】** “XX绕线机张力系统调试标准作业程序”。
        *   **【诊断引导】** “高速断线最常见的三个原因是：1. 张力过大或不稳；2. 过线导轮不光滑；3. 绕线程序参数问题。建议您首先检查张力控制器，实时张力值是多少？”
    5.  **【交互式排查 - 工程师 & Agent】**：小周点开案例和SOP，按照指导检查张力控制器，发现实时张力波动很大。他向Agent反馈：“张力值不稳定，在50-100g之间跳动。”
    6.  **【定位根因 - Agent】**：Agent回复：“张力波动大通常是由于张力传感器或其线路故障。请检查传感器连接线是否有松动或磨损。这是该传感器的电气图纸 [点击查看]。”
    7.  **【解决问题与反馈】**：小周根据图纸检查，发现传感器的一根信号线绝缘皮有磨损，导致信号干扰。他重新处理好线路后，张力恢复稳定，断线问题解决。他在工单中记录了处理过程和原因。
    8.  **【知识沉淀 - 系统后台】**：小周关闭工单后，系统自动将本次“断线->高速运行->张力不稳->传感器线路故障”的完整对话和解决方案，生成了一篇新的知识案例草稿，并推送给设备主管审核。

**【请在此处插入设备智能体交互诊断业务流程图】**

##### **功能架构**

*   **前端 (主要是移动端)：**
    *   **智能对话组件：** 一个类似聊天软件的界面，支持文本、语音、图片输入，并能展示Agent返回的富文本卡片（包含文本、图片、链接、按钮等）。
*   **后端微服务：**
    *   **设备智能体服务 (新增)：** 这是整个智能交互的核心中枢。
        *   **接口层：** 提供与前端交互的WebSocket或RESTful API。
        *   **自然语言理解(NLU)模块：** 对接大语言模型（如开源的ChatGLM、通义千问等，或商业API），负责意图识别、实体提取和上下文管理。
        *   **对话管理(DM)模块：** 控制对话流程，根据NLU的结果和预设的诊断逻辑，决定下一步是提问、推荐还是回答。
        *   **任务执行与编排层：** 这是Agent的“大脑”和“双手”。当需要查询信息时，它会调用**维保管理服务**、**备件管理服务**、**知识库服务**等其他微服务的API来获取数据，然后将结果整合后返回给用户。
        - **知识表示层（RAG）：** 采用检索增强生成（RAG）架构，将正泰的私有知识库（维修案例、SOP等）向量化，当用户提问时，先从向量数据库中检索最相关的知识片段，再将其与问题一起提交给大语言模型，确保模型回答的专业性和准确性，避免“胡说八道”。
*   **数据层与AI平台：**
    *   **向量数据库 (如Milvus, Chroma)：** 存储所有私有知识的向量索引，用于高效的语义相似度检索。
    *   **大语言模型(LLM)服务：** 部署经过领域知识微调的大模型，提供核心的语言理解和生成能力。
    *   **多模态模型服务 (可选)：** 部署用于图像识别等任务的模型。

---
### **4.10 系统管理**
系统管理是保障整个平台安全、稳定、高效运行的基础，为管理员提供了全面的后台配置和监控能力。

##### **详细功能阐述**

1.  **组织架构与用户管理：**
    *   **多级组织架构：** 支持可视化维护公司的组织架构（公司-部门-班组），并与用户关联。
    *   **用户生命周期管理：** 实现用户账号的创建、修改、禁用、删除等全生命周期管理。

2.  **角色与权限管理：**
    *   **基于角色的访问控制(RBAC)：** 系统管理员可定义多种角色（如操作员、维修工、设备主管、系统管理员等）。
    *   **精细化权限分配：** 可为每个角色分配精细的功能权限（可访问的菜单、可执行的操作如增、删、改、查）和数据权限（可查看的数据范围，如只能看本车间的设备）。权限控制可细化到按钮和字段级别。
    *   **用户与角色关联：** 一个用户可以被赋予一个或多个角色，其最终权限是所有角色权限的并集。

3.  **参数配置与数据字典：**
    *   **系统参数配置：** 提供统一的参数配置界面，用于管理系统运行参数，如编码规则、告警阈值、SLA时间标准等。
    *   **数据字典管理：** 维护系统中使用的各类代码和分类，如设备类别、故障类型、工单优先级等，保证数据的一致性和标准化。

4.  **日志管理与审计：**
    *   **操作日志：** 详细记录所有用户的关键操作行为（谁，在什么时间，做了什么），满足安全审计和问题追溯的需求。
    *   **系统日志：** 集中收集所有微服务的运行日志和错误日志，通过ELK等工具进行统一的查询和分析，便于快速定位和解决技术问题。
